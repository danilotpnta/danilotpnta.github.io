<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Danilo Toapanta">
<meta name="dcterms.date" content="2023-11-05">
<meta name="description" content="Notes for course DL1 at University of Amsterdam 3 Nov 2023">

<title>Deep Feedforward Networks – Danilo Toapanta</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/images/danilo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<!-- <link href="../../site_libs/quarto-contrib/material-icons-0.14.2/mi.css" rel="stylesheet"> -->
<script>
window.MathJax = {
  tex: {
    tags: 'ams'
  }
};
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../css/index-posts.css">
</head>

<body class="floating nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <div id="quarto-announcement" data-announcement-id="38450707a32148436d55c280293513e2" class="alert alert-success hidden"><i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p><strong>Let op</strong> - Starting Jan 2025 I will carry out my 36 ECs AI master’s thesis. Have an interesting idea to work on. Let us talk, I am open to <span class="same-color"><a href="https://www.danilotpnta.com/contact/">opportunities</a></span>!</p>
</div></div>
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title"><span id="danilo_topanta_brand"> Danilo Toapanta</span> <a id="mysite" class="mysite" href="../../site-ver-hist/">v1.3</a></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text"><span id="home-welcome-msg">Home</span></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/danilotpnta?tab=repositories" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full blog-page" style="display: none !important;">
    <div class="quarto-title-banner page-columns page-full">
        <div class="quarto-title column-body">
            <h1 class="title">Deep Feedforward Networks</h1>
                
            <!-- Description Block -->
                        <div>
                <div class="description">
                    Notes for course DL1 at University of Amsterdam 3 Nov 2023
                </div>
            </div>
                        
            <!-- Categories Block -->
                                            <div class="quarto-categories">

                    <!-- Display Categories -->
                                            <div class="quarto-category">
                            <a href="../../blog/#category=All">
                                All
                            </a>
                        </div> 
                                            <div class="quarto-category">
                            <a href="../../blog/#category=Deep Learning">
                                Deep Learning
                            </a>
                        </div> 
                                            <div class="quarto-category">
                            <a href="../../blog/#category=TAGS">
                                TAGS
                            </a>
                        </div> 
                    
                    <!-- Display Tags if any -->
                                    </div>
                            
        </div>
    </div>


    
    <div class="quarto-title-meta">

        <div>
        <div class="quarto-title-meta-heading">Author</div>
        <div class="quarto-title-meta-contents">
                 <p><a href="https://danilotpnta.github.io/">Danilo Toapanta</a> </p>
              </div>
      </div>
        
        <div>
        <div class="quarto-title-meta-heading">Published</div>
        <div class="quarto-title-meta-contents">
          <p class="date">November 5, 2023</p>
        </div>
      </div>
      
        
      </div>
      

    
</header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">
<script>
    var currentUrl = window.location.href;
    var index_init_post = currentUrl.lastIndexOf("/20");
    var string_init_post= currentUrl.slice(index_init_post, index_init_post+3 );

    // console.log("currentUrl: " + currentUrl);
    // console.log("index: " + index_init_post);
    // console.log("string: " + string_init_post);

    // If is equal to /blog/20... then make navbar title READING MODE
    if (string_init_post === "/20"){
        let mysite = document.getElementById("mysite");
        mysite.classList.add("mysite-change");

        let navbar = document.getElementById("danilo_topanta_brand");
        navbar.classList.add("navbar-brand-change");

        // This will render a new title saying READING DANILOS BLOG
        // navbar.innerHTML = 'You are Reading Danilo\'s Blog<span style="font-size:35px; vertical-align: middle; opacity: 0.65; padding-bottom: 6px; padding-left: 14px;" class="material-icons-round"> auto_awesome </span>';
        
        const smallDevice = window.matchMedia("(min-width: 570px)");
        smallDevice.addListener(handleDeviceChange);

        function handleDeviceChange(mediaQuery) {
            if (mediaQuery.matches) {
                navbar.innerHTML = "";
                // navbar.innerHTML = "<-- You are Reading Danilo's Blog -->";
            } else  {
                navbar.innerHTML = "Danilo Toapanta";
            }
        }

        // Run it initially
        handleDeviceChange(smallDevice);

        let link = document.getElementsByClassName("navbar-brand")[0];
        link.classList.add("disablePointerEvents");

        let brand_container = document.getElementsByClassName("navbar-brand-container")[0];
        brand_container.classList.add("navbar-brand-container-new-padding");

    }
</script>


<!-- <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Running my first Marathon</h1>
                  <div>
        <div class="description">
          I will be running at the 42km TCS Amsterdam 2023, 15th October
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">News</div>
              </div>
                  </div>
  </div> -->

  <!-- ---
  coming-soon: true
  tags: [Spanish]
  --- -->








<main id="title-block-header" class="quarto-title-block default page-columns page-full" style="padding-bottom: 40px;">

    <div class="quarto-title column-body" style="margin-bottom: 1em;">
        <h1 class="title" style="padding-bottom:8px" ;="">Deep Feedforward Networks</h1>
        
        <!-- Description Block -->
                    <div>
                <div class="description">
                    Notes for course DL1 at University of Amsterdam 3 Nov 2023
                </div>
            </div>
        
        <!-- Categories Block -->
                    
                <!-- Display Categories -->
                <div class="quarto-categories">
                    <!-- <div id="tag-icon-blog" class="quarto-category tags-title">
                        <i class="fa-solid fa-hashtag" ></i> Categories:
                    </div> -->

                                            <div id="All" class="quarto-category">
                            <a href="../../blog/#category=All">
                                All
                            </a>
                        </div>
                                            <div id="Deep Learning" class="quarto-category">
                            <a href="../../blog/#category=Deep Learning">
                                Deep Learning
                            </a>
                        </div>
                                            <div id="TAGS" class="quarto-category">
                            <a href="../../blog/#category=TAGS">
                                TAGS
                            </a>
                        </div>
                                    </div>
                


                <div class="quarto-categories tag-categories">
                    
                    <!-- Tags Icon  -->
                    <!-- <div id="tag-icon-blog" class="quarto-category tags-title"> -->
                        <!-- <i class="fa-solid fa-tag" ></i> Tags: -->
                        <!-- <i class="fa-solid fa-hashtag" ></i> Tags: -->
                        <!-- <span class="material-icons-outlined" >local_offer</span> Tags: -->
                        <!-- / -->
                    <!-- </div> -->

                    <!-- Display Tags -->
                                            <div id="All-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=All">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                All
                            </a>
                        </div>
                                            <div id="Deep Learning-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=Deep Learning">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                Deep Learning
                            </a>
                        </div>
                                            <div id="TAGS-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=TAGS">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                TAGS
                            </a>
                        </div>
                    
                    
                </div>

                    
    </div>


    
    <div class="quarto-title-meta">

        <div>
        <div class="quarto-title-meta-heading">Author</div>
        <div class="quarto-title-meta-contents">
                 <p><a href="https://danilotpnta.github.io/">Danilo Toapanta</a> </p>
              </div>
      </div>
        
        <div>
        <div class="quarto-title-meta-heading">Published</div>
        <div class="quarto-title-meta-contents">
          <p class="date">November 5, 2023</p>
        </div>
      </div>
      
        
      </div>
      

    <!-- Current link: Font-awesome, Google icons, Bootstrap icons -->
    
</main>


<section id="from-linear-functions-to-nonlinear-from-shallow-to-deep" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="from-linear-functions-to-nonlinear-from-shallow-to-deep"><span class="header-section-number">1</span> From linear functions to nonlinear = from shallow to deep</h2>
<center>
<img src="imgs/2023-11-05-03-15-39.png" class="w550 img-fluid">
</center>
<pre></pre>
<p>Here to apply first a Relu and the output of that another Relu: <span class="math inline">\(\sigma(B\sigma(A\textbf{x}))\)</span></p>
</section>
<section id="deep-feedforward-networks" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="deep-feedforward-networks"><span class="header-section-number">2</span> Deep feedforward networks</h2>
<center>
<img src="imgs/2023-11-05-10-05-14.png" class="w550 img-fluid">
</center>
<pre></pre>
<p>MLP is just a combination of multiple linear perceptrons, in each layer there would be parameters ie <span class="math inline">\(A\)</span> is <span class="math inline">\(\theta_1\)</span>, <span class="math inline">\(B\)</span> is <span class="math inline">\(\theta_2\)</span></p>
<center>
<img src="imgs/2023-11-05-10-07-11.png" class="w550 img-fluid">
</center>
<pre></pre>
</section>
<section id="neural-networks-in-blocks" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="neural-networks-in-blocks"><span class="header-section-number">3</span> Neural networks in blocks</h2>
<center>
<img src="imgs/2023-11-05-10-20-29.png" class="w550 img-fluid">
</center>
<pre></pre>
</section>
<section id="non-linear-feature-learning-perspective" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="non-linear-feature-learning-perspective"><span class="header-section-number">4</span> Non-linear feature learning perspective</h2>
<center>
<img src="imgs/2023-11-05-10-36-15.png" class="w550 img-fluid">
</center>
<pre></pre>
<p>Here we are saying that at the end we have just have a linear function <span class="math inline">\(C\)</span> “the linear model” ie.</p>
<p><span class="math display">\[
C(\sigma(B\sigma(A\textbf{x})))
\]</span></p>
<p>to a transformed input <span class="math inline">\(\varphi(x\textbf{x})\)</span> = <span class="math inline">\(\sigma(B\sigma(A\textbf{x}))\)</span></p>
</section>
<section id="how-to-get-w-gradiend-based-learning" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="how-to-get-w-gradiend-based-learning"><span class="header-section-number">5</span> How to get w? gradiend-based learning</h2>
<ul>
<li>Due to nonlinearity our loss function would be nonconvex</li>
<li>We use then SGD</li>
<li>No guarantee of convergence, and sensitive to initialization of the parameters</li>
</ul>
</section>
<section id="cost-function" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="cost-function"><span class="header-section-number">6</span> Cost Function</h2>
<center>
<img src="imgs/2023-11-05-11-44-01.png" class="w550 img-fluid">
</center>
<center>
<img src="imgs/2023-11-05-11-46-27.png" class="w550 img-fluid">
</center>
<center>
<img src="imgs/2023-11-05-11-46-42.png" class="w550 img-fluid">
</center>
<center>
<img src="imgs/2023-11-05-11-51-55.png" class="w550 img-fluid">
</center>
<pre></pre>
<p>Here saturated means that the function becomes very flat so then the gradient of this is very minimal so then we cannot compute optimize because all the derivatives would look like very similar</p>
</section>
<section id="activation-functions" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="activation-functions"><span class="header-section-number">7</span> Activation Functions</h2>
<center>
<img src="imgs/2023-11-05-11-56-34.png" class="w550 img-fluid">
</center>
<pre></pre>
<ul>
<li>Defined how the weighted sum of the input is transformed into an output from a node or nodes in a layer of the network.</li>
<li>If output range limited, then called a “squashing function.”</li>
<li>The choice of activation function has a large impact on the capability and performance of the neural network.</li>
<li>Different activation functions may be combined, but rare</li>
<li>All hidden layers typically use the same activation function</li>
<li>Need to be differentiable at most points</li>
</ul>
</section>
<section id="linear-units-fully-connected-layer" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="linear-units-fully-connected-layer"><span class="header-section-number">8</span> Linear Units/ “Fully connected layer”</h2>
<center>
<img src="imgs/2023-11-05-13-37-29.png" class="w550 img-fluid">
</center>
<center>
<img src="imgs/2023-11-05-13-37-39.png" class="w550 img-fluid">
</center>
</section>
<section id="advantages-of-relu" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="advantages-of-relu"><span class="header-section-number">9</span> Advantages of ReLU</h2>
<center>
<img src="imgs/2023-11-05-13-40-29.png" class="w550 img-fluid">
</center>
<p>ReLu is better for propagation because if i.e take a sin as activation function when we derive close to zero the gradient would be very small, we keep doing this over multiple layers and essentially multiplying small times smalls at the end the result would be close to <span class="math inline">\(0\)</span>.</p>
</section>
<section id="disadvantages-of-relu" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="disadvantages-of-relu"><span class="header-section-number">10</span> Disadvantages of ReLU</h2>
<center>
<img src="imgs/2023-11-05-13-45-49.png" class="w550 img-fluid">
</center>
</section>
<section id="leaky-relu" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="leaky-relu"><span class="header-section-number">11</span> Leaky ReLU</h2>
<center>
<img src="imgs/2023-11-05-13-51-40.png" class="w550 img-fluid">
</center>
</section>
<section id="exponential-linear-unit-elu" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="exponential-linear-unit-elu"><span class="header-section-number">12</span> Exponential Linear Unit (ELU)</h2>
<center>
<img src="imgs/2023-11-05-13-54-11.png" class="w550 img-fluid">
</center>
<p>Used in Language models like BERT</p>
</section>
<section id="gaussian-error-linear-unit" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="gaussian-error-linear-unit"><span class="header-section-number">13</span> Gaussian Error Linear Unit</h2>
<center>
<img src="imgs/2023-11-05-13-55-24.png" class="w550 img-fluid">
</center>
<pre></pre>
<p>We are not bounded by the computation power but by memory to be loaded in the computation units of the GPUs on Snellius</p>
</section>
<section id="sigmoid-and-tanh" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="sigmoid-and-tanh"><span class="header-section-number">14</span> Sigmoid and Tanh</h2>
<center>
<img src="imgs/2023-11-05-14-00-24.png" class="w550 img-fluid">
</center>
<pre></pre>
<center>
<img src="imgs/2023-11-05-14-01-24.png" class="w275 img-fluid">
</center>
<pre></pre>
</section>
<section id="softmax" class="level2" data-number="15">
<h2 data-number="15" class="anchored" data-anchor-id="softmax"><span class="header-section-number">15</span> Softmax</h2>
<center>
<img src="imgs/2023-11-05-14-06-20.png" class="w550 img-fluid">
</center>
<pre></pre>
<p>It outputs a probability distribution because it depends on the denominator which means all the variables would be taken into account. For instance this can be the last activation function to output probabilities of predicting a cat, a dog, a bird and so on.</p>
<p>If we now introduce a term <span class="math inline">\(\tau\)</span> in Softmax (by dividing the <span class="math inline">\(e^{\frac{x_i}{\tau}}\)</span> in the numerator and denominator) then we have the following:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Softamx and <span class="math inline">\(\tau\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>If τ is introduced, it can be used to control the temperature or the “sharpness” of the softmax distribution.</p>
<p>When τ is set to a value greater than 1, it has the effect of “softening” the probabilities, making the distribution more uniform. In other words, it makes the probability of all categories more similar to each other. This can be useful in scenarios where you want to explore a wider range of possibilities or reduce the impact of extreme values in the input vector.</p>
<p>Conversely, when τ is set to a value less than 1, it has the effect of “sharpening” the probabilities, making the distribution more peaky, and emphasizing the largest values in the input vector. This can be useful when you want to make more distinct predictions and reduce uncertainty.</p>
</div>
</div>
</section>
<section id="how-to-choose-and-activation-function" class="level2" data-number="16">
<h2 data-number="16" class="anchored" data-anchor-id="how-to-choose-and-activation-function"><span class="header-section-number">16</span> How to Choose and Activation Function</h2>
<center>
<img src="imgs/2023-11-05-14-23-43.png" class="w550 img-fluid">
</center>
<p>Here inference is testing or predicting</p>
<section id="difference-between-multiclass-classification-vs-multilabel-calssification" class="level3" data-number="16.1">
<h3 data-number="16.1" class="anchored" data-anchor-id="difference-between-multiclass-classification-vs-multilabel-calssification"><span class="header-section-number">16.1</span> Difference between Multiclass classification vs Multilabel calssification</h3>
<ol type="1">
<li><p>Multiclass Classification:</p>
<ul>
<li>In multiclass classification, the task is to assign an input data point to one and only one class or category from a set of multiple mutually exclusive classes.</li>
<li>Each data point belongs to exactly one class, and the goal is to determine which class that data point most likely belongs to.</li>
<li>Examples of multiclass classification problems:
<ul>
<li>Handwritten digit recognition: Given an image of a handwritten digit (0-9), determine which digit it represents.</li>
<li>Species classification: Given a photo of an animal, classify it into one of several species (e.g., dog, cat, bird, etc.).</li>
</ul></li>
</ul>
<p>Example: Suppose you have a multiclass classification problem where you want to classify fruits into three categories: apples, oranges, and bananas. If you input an image of an apple, the model should predict that it belongs to the “apples” class.</p></li>
<li><p>Multilabel Classification:</p>
<ul>
<li>In multilabel classification, each data point can be associated with one or more classes or labels. It’s not limited to assigning a single class per data point.</li>
<li>This is used when a data point can have multiple attributes or characteristics simultaneously, and you want to predict all relevant labels.</li>
<li>Examples of multilabel classification problems:
<ul>
<li>Document categorization: Tagging a document with multiple topics or subjects that are present in it.</li>
<li>Image tagging: Assigning tags to an image to describe its content, where an image may contain multiple objects or scenes.</li>
</ul></li>
</ul>
<p>Example: Consider an image tagging problem. You have an image containing a beach scene with a dog and a sunset. In a multilabel classification scenario, the model might predict the following labels: “beach,” “dog,” and “sunset,” because all three labels are relevant to the image.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How to use Softmax in a Multiclass Classification problem?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In a multiclass classification problem, the softmax function is commonly used to convert the raw output scores of a model into a probability distribution over multiple classes. This probability distribution allows you to determine the likelihood of each class for a given input data point. Here’s how you use the softmax function in a multiclass classification problem:</p>
<ol type="1">
<li>Model Output:
<ul>
<li>After training your multiclass classification model, you will typically have a final layer in your neural network or a scoring function that produces raw scores (logits) for each class. These scores are not yet probabilities but represent the model’s confidence in each class.</li>
<li>Let’s say you have N classes, and the model’s output for a particular input is a vector of raw scores <span class="math inline">\(z\)</span> with N elements, one for each class.</li>
</ul></li>
<li>Apply Softmax Function:
<ul>
<li>To convert the raw scores into probabilities, apply the softmax function to the <span class="math inline">\(z\)</span> vector. The softmax function transforms the scores into a probability distribution where the sum of the probabilities for all classes equals 1.</li>
<li>The softmax function for class <span class="math inline">\(i\)</span> is given by: <span class="math inline">\(\text{softmax}(z)_i = \frac{e^{z_i}}{\sum_{j=1}^N e^{z_j}}\)</span></li>
<li>Calculate the softmax value for each class <span class="math inline">\(i\)</span> in the <span class="math inline">\(z\)</span> vector to obtain a probability distribution.</li>
</ul></li>
<li>Predict the Class:
<ul>
<li>The class with the highest probability in the softmax distribution is typically chosen as the predicted class for the input data point. In other words, the class with the highest <span class="math inline">\(\text{softmax}(z)_i\)</span> value is the model’s prediction for that input.</li>
</ul></li>
</ol>
<p>Here’s a step-by-step example of using softmax for multiclass classification:</p>
<p>Suppose you have a multiclass classification problem with three classes: “cat,” “dog,” and “bird.” After processing an input image, your model produces the following raw scores:</p>
<p><span class="math inline">\(z = [2.1, 0.9, 1.5]\)</span></p>
<ol type="1">
<li>Apply the softmax function:
<ul>
<li>Calculate the softmax values for each class:<br>
<span class="math inline">\(\text{softmax}(z)_1 = \frac{e^{2.1}}{e^{2.1} + e^{0.9} + e^{1.5}}\)</span><br>
<span class="math inline">\(\text{softmax}(z)_2 = \frac{e^{0.9}}{e^{2.1} + e^{0.9} + e^{1.5}}\)</span><br>
<span class="math inline">\(\text{softmax}(z)_3 = \frac{e^{1.5}}{e^{2.1} + e^{0.9} + e^{1.5}}\)</span></li>
</ul></li>
<li>Predict the class:
<ul>
<li>The class with the highest softmax probability is the predicted class. In this case, if <span class="math inline">\(\text{softmax}(z)_1\)</span> is the highest probability, the model predicts “cat.”</li>
</ul></li>
</ol>
<p>Using the softmax function in multiclass classification allows you to obtain a probability distribution over classes and select the most likely class as the model’s prediction.</p>
</div>
</div>
</div>
</section>
</section>
<section id="width-and-depth" class="level2" data-number="17">
<h2 data-number="17" class="anchored" data-anchor-id="width-and-depth"><span class="header-section-number">17</span> Width and Depth</h2>
<center>
<img src="imgs/2023-11-05-15-22-52.png" class="w550 img-fluid">
</center>
<pre></pre>
<p>If we have a single big hidden layer (so a lot of parameters) can approximate any functions but in practice this infeasible.</p>
<ul>
<li><strong>Width</strong> is how many neurons in a single layer</li>
<li><strong>Depth</strong> is the number of layers</li>
</ul>
<p>This also does not tell you how many hidden units you would need. The theorem just says to approx any function you need infinitely.</p>
<center>
<img src="imgs/2023-11-05-15-32-01.png" class="w550 img-fluid">
</center>
<pre></pre>
<p>Here we are saying that Deeper models reduce the loss functions (reduce the generalization error) because they generalize better meaning do not overfit. So do not need one single layer with a lot of neurons but instead multiple layers with fewer neurons.</p>
<section id="convolution-neural-networks-vsfully-connected-neural-networks" class="level3" data-number="17.1">
<h3 data-number="17.1" class="anchored" data-anchor-id="convolution-neural-networks-vsfully-connected-neural-networks"><span class="header-section-number">17.1</span> Convolution Neural Networks vsFully Connected Neural Networks</h3>
<center>
<img src="imgs/2023-11-05-15-38-28.png" class="w150 img-fluid">
</center>
<pre></pre>
<p>Convolutional needs lees parameters as their inputs are not fully connected to every neuron see pic above</p>
<center>
<img src="imgs/2023-11-05-15-40-57.png" class="w550 img-fluid">
</center>
<pre></pre>
<ul>
<li>3 Convolutional is worse than 11 Convolutional, because the latter is more deeper</li>
</ul>
</section>
</section>
<section id="neural-network-architectures-jungle" class="level2" data-number="18">
<h2 data-number="18" class="anchored" data-anchor-id="neural-network-architectures-jungle"><span class="header-section-number">18</span> Neural Network architectures (jungle)</h2>
<center>
<img src="imgs/2023-11-05-15-43-44.png" class="w550 img-fluid">
</center>
<pre></pre>
</section>
<section id="computational-graph" class="level2" data-number="19">
<h2 data-number="19" class="anchored" data-anchor-id="computational-graph"><span class="header-section-number">19</span> Computational graph</h2>
<center>
<img src="imgs/2023-11-05-16-06-31.png" class="w550 img-fluid">
</center>
<pre></pre>
<section id="example" class="level3" data-number="19.1">
<h3 data-number="19.1" class="anchored" data-anchor-id="example"><span class="header-section-number">19.1</span> Example</h3>
<center>
<img src="imgs/2023-11-05-16-17-30.png" class="w550 img-fluid">
</center>
<pre></pre>
<p>Problem with activation function ReLU</p>
<center>
<img src="imgs/2023-11-05-16-23-37.png" class="w550 img-fluid">
</center>
<pre></pre>
</section>
</section>
<section id="chain-rule-of-calculus" class="level2" data-number="20">
<h2 data-number="20" class="anchored" data-anchor-id="chain-rule-of-calculus"><span class="header-section-number">20</span> Chain Rule of Calculus</h2>
<center>
<img src="imgs/2023-11-05-16-30-08.png" class="w550 img-fluid">
</center>
<pre></pre>
<center>
<img src="imgs/2023-11-05-16-30-24.png" class="w550 img-fluid">
</center>
</section>
<section id="the-jacobian" class="level2" data-number="21">
<h2 data-number="21" class="anchored" data-anchor-id="the-jacobian"><span class="header-section-number">21</span> The Jacobian</h2>
<center>
<img src="imgs/2023-11-05-16-32-28.png" class="w550 img-fluid">
</center>
<pre></pre>
<center>
<img src="imgs/2023-11-05-16-48-57.png" class="w550 img-fluid">
</center>
<pre></pre>
<ul>
<li>The Jacobian measures how a change in the input changes the output</li>
<li>The <strong>shape</strong> of the Jacobian is ouputs x inputs</li>
</ul>
</section>
<section id="computing-gradients-in-complex-functions-chain-rule" class="level2" data-number="22">
<h2 data-number="22" class="anchored" data-anchor-id="computing-gradients-in-complex-functions-chain-rule"><span class="header-section-number">22</span> Computing gradients in complex functions: Chain rule</h2>
<center>
<img src="imgs/2023-11-05-16-55-47.png" class="w550 img-fluid">
</center>
<pre></pre>
</section>
<section id="chain-rule-and-tensors-intuitively" class="level2" data-number="23">
<h2 data-number="23" class="anchored" data-anchor-id="chain-rule-and-tensors-intuitively"><span class="header-section-number">23</span> Chain rule and tensors, intuitively</h2>
<center>
<img src="imgs/2023-11-05-16-58-34.png" class="w550 img-fluid">
</center>
<pre></pre>
</section>
<section id="example-1" class="level2" data-number="24">
<h2 data-number="24" class="anchored" data-anchor-id="example-1"><span class="header-section-number">24</span> Example</h2>
<center>
<img src="imgs/2023-11-05-17-02-23.png" class="w550 img-fluid">
</center>
<pre></pre>
<center>
<img src="imgs/2023-11-05-17-02-55.png" class="w550 img-fluid">
</center>
<pre></pre>
</section>
<section id="backpropagation-chain-rule" class="level2" data-number="25">
<h2 data-number="25" class="anchored" data-anchor-id="backpropagation-chain-rule"><span class="header-section-number">25</span> Backpropagation Chain Rule</h2>
<center>
<img src="imgs/2023-11-05-19-36-24.png" class="w550 img-fluid">
</center>
<center>
<img src="imgs/2023-11-05-19-50-46.png" class="w550 img-fluid">
</center>
<center>
<img src="imgs/2023-11-05-19-50-59.png" class="w550 img-fluid">
</center>
<pre></pre>
<section id="backpropagation-in-summary" class="level3" data-number="25.1">
<h3 data-number="25.1" class="anchored" data-anchor-id="backpropagation-in-summary"><span class="header-section-number">25.1</span> Backpropagation in summary</h3>
<center>
<img src="imgs/2023-11-05-19-52-27.png" class="w575 img-fluid">
</center>
<center>
<img src="imgs/2023-11-05-19-59-07.png" class="w575 img-fluid">
</center>
<pre></pre>
<ul>
<li>Note: in the figure above, we know what is <span class="math inline">\(h_0\)</span>, <span class="math inline">\(h_1\)</span>, <span class="math inline">\(h_2\)</span> and <span class="math inline">\(L\)</span> because we have initialized our <span class="math inline">\(w_1\)</span> and <span class="math inline">\(w_2\)</span> and we also know how the sigmoid function works:</li>
</ul>
<center>
<img src="imgs/2023-11-05-20-49-31.png" class="w250 img-fluid">
</center>
<pre></pre>
<ul>
<li><p>That means all these values are known so that when we calculate the derivatives below everything is know and then we can use SGD to update the weights</p></li>
<li><p>Then the derivatives wrt. <span class="math inline">\(w\)</span> are:</p></li>
</ul>
<center>
<img src="imgs/2023-11-05-20-08-51.png" class="w250 img-fluid">
</center>
<pre></pre>
<ul>
<li>These last equations is what we need to do SGD</li>
</ul>
<p>Backprogation allows us to generally reduce the amount of space we need in order to compute all the gradients for all the layers, because storing the Jacobian takes a lot of space.</p>
</section>
</section>
<section id="chain-rule-visualized" class="level2" data-number="26">
<h2 data-number="26" class="anchored" data-anchor-id="chain-rule-visualized"><span class="header-section-number">26</span> Chain rule visualized</h2>
<center>
<img src="imgs/2023-11-05-20-24-57.png" class="w550 img-fluid">
</center>
<pre></pre>
<ul>
<li>But now if the ouput is an scalar, we get in the ouput a vector:</li>
</ul>
<center>
<img src="imgs/2023-11-05-20-27-37.png" class="w550 img-fluid">
</center>
<pre></pre>
<ul>
<li>Now from the back to front you are only multiplying vector times matrices instead of large matrices with large matrices</li>
</ul>
<center>
<img src="imgs/2023-11-05-20-29-47.png" class="w550 img-fluid">
</center>
<center>
<img src="imgs/2023-11-05-20-30-02.png" class="w550 img-fluid">
</center>
<center>
<img src="imgs/2023-11-05-20-30-18.png" class="w550 img-fluid">
</center>
<center>
<img src="imgs/2023-11-05-20-30-26.png" class="w550 img-fluid">
</center>
</section>
<section id="but-we-still-need-the-jacobian" class="level2" data-number="27">
<h2 data-number="27" class="anchored" data-anchor-id="but-we-still-need-the-jacobian"><span class="header-section-number">27</span> But we still need the Jacobian</h2>
<center>
<img src="imgs/2023-11-05-20-30-51.png" class="w550 img-fluid">
</center>
<pre></pre>
</section>
<section id="computational-graphs-forward-graph" class="level2" data-number="28">
<h2 data-number="28" class="anchored" data-anchor-id="computational-graphs-forward-graph"><span class="header-section-number">28</span> Computational graphs: Forward graph</h2>
<center>
<img src="imgs/2023-11-05-20-44-54.png" class="w550 img-fluid">
</center>
<pre></pre>
</section>
<section id="computational-graphs-forward-graph-1" class="level2" data-number="29">
<h2 data-number="29" class="anchored" data-anchor-id="computational-graphs-forward-graph-1"><span class="header-section-number">29</span> Computational graphs: Forward graph</h2>
<center>
<img src="imgs/2023-11-05-20-45-27.png" class="w550 img-fluid">
</center>
<pre></pre>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.danilotpnta\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../about/index.html">
<p><span class="footerDaniloToapanta">© 2024 Danilo Toapanta</span></p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../privacy/index.html">
<p>Privacy</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../contact/index.html">
<p>Contact</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../license/index.html">
<p>License</p>
</a>
  </li>  
</ul>
    <div class="toc-actions"><ul><li><a href="https://github.com/danilotpnta/danilotpnta.github.io/blob/main/blog/2023-11-05_deep-feedforward-networks/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/danilotpnta/danilotpnta.github.io/edit/main/blog/2023-11-05_deep-feedforward-networks/index.qmd" class="toc-action"><i class="bi empty"></i>Edit this page</a></li><li><a href="https://github.com/danilotpnta/danilotpnta.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/danilotpnta/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/DaniloToapnta">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../docs/sitemap.xml">
      <i class="bi bi-rss-fill" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>

    let navbar = document.getElementsByClassName("navbar-nav")[0]    

    let li2 = document.createElement("li");
    li2.className = "nav-item compact";

    let a2 = document.createElement("a");
    a2.className = "nav-link quarto-color-scheme-toggle";
    a2.style.cursor = "pointer"
    li2.appendChild(a2)

    let i2 = document.createElement("i");
    i2.className = "bi bi-moon"
    a2.append(i2)

    navbar.appendChild(li2);

    i2.onclick = function() {
        window.quartoToggleColorScheme(); return false;
    }
    // <a href="http://localhost:4200/about/" class="quarto-color-scheme-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>

    let li = document.createElement("li");
    li.className = "nav-item compact";

    let a = document.createElement("a");
    a.className = "nav-link";
    a.style.cursor = "pointer"
    li.appendChild(a)

    let i = document.createElement("i");
    i.className = "bi bi-search"
    a.append(i)

    // let span = document.createElement("span");
    // span.className = "menu-text"
    // a.append(span)

    navbar.appendChild(li);

    a.onclick = function() {
        window.quartoOpenSearch()
    }


</script>






</body></html>