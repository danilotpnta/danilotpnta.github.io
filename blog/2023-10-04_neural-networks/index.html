<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Danilo Toapanta">
<meta name="dcterms.date" content="2023-10-04">
<meta name="description" content="Lecture Notes on 26-9-2023">

<title>Neural networks – Danilo Toapanta</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/danilo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<!-- <link href="../../site_libs/quarto-contrib/material-icons-0.14.2/mi.css" rel="stylesheet"> -->
<script>
window.MathJax = {
  tex: {
    tags: 'ams'
  }
};
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../css/index-posts.css">
</head>

<body class="floating nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <div id="quarto-announcement" data-announcement-id="af66dd50c39dd2ed9de488e10a192054" class="alert alert-primary hidden"><i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p><strong>Let op</strong> - This website is undergoing scheduled maintenance</p>
</div></div>
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title"><span id="danilo_topanta_brand"> Danilo Toapanta</span> <a id="mysite" class="mysite" href="../../site-ver-hist/">v1.3</a></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text"><span id="home-welcome-msg">Home</span></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/danilotpnta?tab=repositories" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full blog-page" style="display: none !important;">
    <div class="quarto-title-banner page-columns page-full">
        <div class="quarto-title column-body">
            <h1 class="title">Neural networks</h1>
                
            <!-- Description Block -->
                        <div>
                <div class="description">
                    Lecture Notes on 26-9-2023
                </div>
            </div>
                        
            <!-- Categories Block -->
                                            <div class="quarto-categories">

                    <!-- Display Categories -->
                                            <div class="quarto-category">
                            <a href="../../blog/#category=All">
                                All
                            </a>
                        </div> 
                                            <div class="quarto-category">
                            <a href="../../blog/#category=Machine Learning">
                                Machine Learning
                            </a>
                        </div> 
                                            <div class="quarto-category">
                            <a href="../../blog/#category=TAGS">
                                TAGS
                            </a>
                        </div> 
                                            <div class="quarto-category">
                            <a href="../../blog/#category=Python">
                                Python
                            </a>
                        </div> 
                    
                    <!-- Display Tags if any -->
                                    </div>
                            
        </div>
    </div>


    
    <div class="quarto-title-meta">

        <div>
        <div class="quarto-title-meta-heading">Author</div>
        <div class="quarto-title-meta-contents">
                 <p><a href="https://danilotpnta.github.io/">Danilo Toapanta</a> </p>
              </div>
      </div>
        
        <div>
        <div class="quarto-title-meta-heading">Published</div>
        <div class="quarto-title-meta-contents">
          <p class="date">October 4, 2023</p>
        </div>
      </div>
      
        
      </div>
      

    
</header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">
<script>
    var currentUrl = window.location.href;
    var index_init_post = currentUrl.lastIndexOf("/20");
    var string_init_post= currentUrl.slice(index_init_post, index_init_post+3 );

    // console.log("currentUrl: " + currentUrl);
    // console.log("index: " + index_init_post);
    // console.log("string: " + string_init_post);

    // If is equal to /blog/20... then make navbar title READING MODE
    if (string_init_post === "/20"){
        let mysite = document.getElementById("mysite");
        mysite.classList.add("mysite-change");

        let navbar = document.getElementById("danilo_topanta_brand");
        navbar.classList.add("navbar-brand-change");

        // This will render a new title saying READING DANILOS BLOG
        // navbar.innerHTML = 'You are Reading Danilo\'s Blog<span style="font-size:35px; vertical-align: middle; opacity: 0.65; padding-bottom: 6px; padding-left: 14px;" class="material-icons-round"> auto_awesome </span>';
        
        const smallDevice = window.matchMedia("(min-width: 570px)");
        smallDevice.addListener(handleDeviceChange);

        function handleDeviceChange(mediaQuery) {
            if (mediaQuery.matches) {
                navbar.innerHTML = "";
                // navbar.innerHTML = "<-- You are Reading Danilo's Blog -->";
            } else  {
                navbar.innerHTML = "Danilo Toapanta";
            }
        }

        // Run it initially
        handleDeviceChange(smallDevice);

        let link = document.getElementsByClassName("navbar-brand")[0];
        link.classList.add("disablePointerEvents");

        let brand_container = document.getElementsByClassName("navbar-brand-container")[0];
        brand_container.classList.add("navbar-brand-container-new-padding");

    }
</script>


<!-- <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Running my first Marathon</h1>
                  <div>
        <div class="description">
          I will be running at the 42km TCS Amsterdam 2023, 15th October
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">News</div>
              </div>
                  </div>
  </div> -->

  <!-- ---
  coming-soon: true
  tags: [Spanish]
  --- -->








<main id="title-block-header" class="quarto-title-block default page-columns page-full" style="padding-bottom: 40px;">

    <div class="quarto-title column-body" style="margin-bottom: 1em;">
        <h1 class="title" style="padding-bottom:8px" ;="">Neural networks</h1>
        
        <!-- Description Block -->
                    <div>
                <div class="description">
                    Lecture Notes on 26-9-2023
                </div>
            </div>
        
        <!-- Categories Block -->
                    
                <!-- Display Categories -->
                <div class="quarto-categories">
                    <!-- <div id="tag-icon-blog" class="quarto-category tags-title">
                        <i class="fa-solid fa-hashtag" ></i> Categories:
                    </div> -->

                                            <div id="All" class="quarto-category">
                            <a href="../../blog/#category=All">
                                All
                            </a>
                        </div>
                                            <div id="Machine Learning" class="quarto-category">
                            <a href="../../blog/#category=Machine Learning">
                                Machine Learning
                            </a>
                        </div>
                                            <div id="TAGS" class="quarto-category">
                            <a href="../../blog/#category=TAGS">
                                TAGS
                            </a>
                        </div>
                                            <div id="Python" class="quarto-category">
                            <a href="../../blog/#category=Python">
                                Python
                            </a>
                        </div>
                                    </div>
                


                <div class="quarto-categories tag-categories">
                    
                    <!-- Tags Icon  -->
                    <!-- <div id="tag-icon-blog" class="quarto-category tags-title"> -->
                        <!-- <i class="fa-solid fa-tag" ></i> Tags: -->
                        <!-- <i class="fa-solid fa-hashtag" ></i> Tags: -->
                        <!-- <span class="material-icons-outlined" >local_offer</span> Tags: -->
                        <!-- / -->
                    <!-- </div> -->

                    <!-- Display Tags -->
                                            <div id="All-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=All">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                All
                            </a>
                        </div>
                                            <div id="Machine Learning-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=Machine Learning">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                Machine Learning
                            </a>
                        </div>
                                            <div id="TAGS-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=TAGS">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                TAGS
                            </a>
                        </div>
                                            <div id="Python-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=Python">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                Python
                            </a>
                        </div>
                    
                    
                </div>

                    
    </div>


    
    <div class="quarto-title-meta">

        <div>
        <div class="quarto-title-meta-heading">Author</div>
        <div class="quarto-title-meta-contents">
                 <p><a href="https://danilotpnta.github.io/">Danilo Toapanta</a> </p>
              </div>
      </div>
        
        <div>
        <div class="quarto-title-meta-heading">Published</div>
        <div class="quarto-title-meta-contents">
          <p class="date">October 4, 2023</p>
        </div>
      </div>
      
        
      </div>
      

    <!-- Current link: Font-awesome, Google icons, Bootstrap icons -->
    
</main>


<p>The only difference between the normal perceptron and the logistic regression its how we compute the activation function the f(x)</p>
<center>
<img src="imgs/2023-10-06-15-17-12.png" class="w400 img-fluid">
</center>
<ul>
<li>When we use Logistic REgression we get an answer in terms of probabilities so from 0 to 1, the perceptron did not have this property. It will just give us a <span class="math inline">\(+1\)</span> or <span class="math inline">\(-1\)</span></li>
</ul>
<p>The perceptron cannot solve the XOR problem also the logistic regression. To get around this problem, we stack perceptron like in a layer fashion model. This is called <strong>Multilayer Perceptron</strong></p>
<p>But because people start to use the logistic regression instead of the actual hardcore perceptron output (so <span class="math inline">\(+1\)</span> or <span class="math inline">\(-1\)</span>) then we now call it. <strong>Multilayer Logistic Regression</strong></p>
<p>So instead of that we are gonna have different activation functions</p>
<center>
<img src="imgs/2023-10-06-15-17-40.png" class="w400 img-fluid">
</center>
<p>We also talked about QDA this is a non linear model classifier</p>
<center>
<img src="imgs/2023-10-04-15-49-21.png" class="w400 img-fluid">
</center>
<p>We call the computation from going to the input to the ouput as forward propagation</p>
<center>
<img src="imgs/2023-10-04-15-54-45.png" class="w400 img-fluid">
</center>
<p>The number of parameters for Logistic Regression is <span class="math inline">\(D+1\)</span> vs Gaussian Classifier contains <span class="math inline">\(D^2\)</span>. all these computation.</p>
<p>So when you get scared about the number of layers then you just remember the previous layers they were just a type of basis funtions and the last layer is a linear model like so:</p>
<center>
<img src="imgs/2023-10-04-16-03-12.png" class="w400 img-fluid">
</center>
<p>The difference between linear models with adaptive basis is that the Neural Networks <strong>learn</strong> the basis functions.</p>
<p>With Neural Networks we do not have to have heuristics for this basis functions but they learn by themselves.</p>
<center>
<img src="imgs/2023-10-04-16-24-56.png" class="w300 img-fluid">
</center>
<p>We see that to separate our data from above we can use one hidden layer with tree units:</p>
<center>
<img src="imgs/2023-10-04-16-24-32.png" class="w400 img-fluid">
</center>
<p>Recall from the previous lecture that with our Logistic Regression we neede to have some radial functions, the difference here its that we can now gotten learnt this basis functions with our Neural Network.</p>
<p>NN start with low level features and keeps increasing until it calculates the features it find relevant to take a decision.</p>
<center>
<img src="imgs/2023-10-04-16-30-50.png" class="w400 img-fluid">
</center>
<ul>
<li><strong>Recurrent Neural Networks</strong>: good for sentences analysis because the new hidden layer depend on the ouput of the previous hidden layers before.</li>
<li><strong>Convolution Neural Networks</strong>: you can recognize objects.</li>
</ul>
<p>It is spacial invariant because you are moving your kernel along all dimensions.</p>
<section id="universal-approximators" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="universal-approximators"><span class="header-section-number">1</span> Universal Approximators</h2>
<p>We can find a number M and for the weights <span class="math inline">\(\textbf{w}^(2)\)</span> so the weights in the second layer. Here <span class="math inline">\(M\)</span> represents the units aka the circles in a layer. See the green highlighted circles below</p>
<center>
<img src="imgs/2023-10-04-17-53-13.png" class="img-fluid">
</center>
<pre></pre>
<p>If we want the error to be to zero then we want the value of <span class="math inline">\(M\)</span> to be larger and larger. This is because we fixed our NN to have only 2 layers so the only thing that can grow its the widht so <span class="math inline">\(M\)</span> so the number of neurons (units). So with M its hard if you compute plenty of them because then you need a lot of GPUs.</p>
<p>The summary of the <strong>Universal Approximator</strong> is that width <span class="math inline">\(M\)</span> is the one that matter. It is just one hidden layer and if you can make it big enough, so if you can increase <span class="math inline">\(M\)</span> enough then you can fit approximate almost anything</p>
<center>
<img src="imgs/2023-10-05-20-16-17.png" class="img-fluid">
</center>
<pre></pre>
<p>Here <span class="math inline">\(\textbf{w}^2 \in \mathbb{R}^{Mx1}\)</span> because if we want to compute only one single value at the end of the NN we need the dimensions of the vector to align see figure above</p>
</section>
<section id="deep-neural-nets-and-shallow-neural-nets" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="deep-neural-nets-and-shallow-neural-nets"><span class="header-section-number">2</span> Deep Neural Nets and Shallow Neural Nets</h2>
<center>
<img src="imgs/2023-10-05-19-29-24.png" class="w450 img-fluid">
</center>
<p>Here we are saying that if we want to conserve the error lower as much as a Deep Neural Net, so that we can have a Shallow Neural Net then we need to increase the number of <span class="math inline">\(M\)</span> or number of weights. But by doing so this scales exponentially.</p>
<p>To <strong>growth complexity</strong> you have to increase the <strong>width</strong>, but instead of this you can do it in the depth. As we will see in the slide below, Depth gives you more complexity so its preferable to increase depth instead of width</p>
<ul>
<li>Width: <span class="math inline">\(M\)</span> number of weights<br>
If you want the error small then increase this number. However if you go this route the number <span class="math inline">\(M(\varepsilon)\)</span> grows exponentially</li>
<li>Depth: <span class="math inline">\(l\)</span> number of hidden layers.<br>
Here it gives you more complexity, so its recommended, End result have deeper NNs.</li>
</ul>
<p><cente><img src="imgs/2023-10-05-20-24-53.png" class="img-fluid"></cente></p>
<p>The point of the image above is to show that with the same model (3 hidden units and 1 linesr ouput unit) which is the Neural Network we can approximate these 4 functions.</p>
</section>
<section id="expressive-power-relu-networks" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="expressive-power-relu-networks"><span class="header-section-number">3</span> Expressive power ReLU networks</h2>
<center>
<img src="imgs/2023-10-05-19-45-28.png" class="w425 img-fluid">
</center>
</section>
<section id="network-training-regression" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="network-training-regression"><span class="header-section-number">4</span> Network Training: Regression</h2>
<p>Remember computing the Maximum Likelihood is the same as the minimum of the <strong>negative</strong> log likelihood, that is why there is a minus on front the <span class="math inline">\(\ln p(\textbf{t}|\textbf{W},\textbf{w})\)</span></p>
<center>
<img src="imgs/2023-10-05-20-57-56.png" class="img-fluid">
</center>
</section>
<section id="network-training" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="network-training"><span class="header-section-number">5</span> Network Training</h2>
<section id="regression-network-training" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="regression-network-training"><span class="header-section-number">5.1</span> Regression: Network Training</h3>
<center>
<img src="imgs/2023-10-05-23-08-21.png" class="img-fluid">
</center>
</section>
<section id="binary-classification-network-training" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="binary-classification-network-training"><span class="header-section-number">5.2</span> Binary Classification: Network Training</h3>
<p><img src="imgs/2023-10-05-23-09-11.png" class="w425 img-fluid"></p>
</section>
<section id="classification-with-k-classes-network-training" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="classification-with-k-classes-network-training"><span class="header-section-number">5.3</span> Classification with K classes: Network Training</h3>
<center>
<img src="imgs/2023-10-06-13-51-47.png" class="img-fluid">
</center>
<p>For further explanation in class distribution take a look at <a href="https://www.youtube.com/watch?v=421uW9aZHio&amp;ab_channel=MachineLearning%26Simulation">here</a></p>
</section>
</section>
<section id="losses-overview" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="losses-overview"><span class="header-section-number">6</span> Losses overview</h2>
<center>
<img src="imgs/2023-10-06-13-52-34.png" class="img-fluid">
</center>
<center>
<img src="imgs/2023-10-06-13-55-06.png" class="w400 img-fluid">
</center>
</section>
<section id="training-neural-networks" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="training-neural-networks"><span class="header-section-number">7</span> Training Neural Networks</h2>
<p>Because we cannot find easily the mathematically solutions for training the NN, we use <strong>Gradient Descent</strong></p>
<center>
<img src="imgs/2023-10-06-14-11-07.png" class="w400 img-fluid">
</center>
<pre></pre>
<p>Result of <strong>forward propagation</strong>. Depends on all the NN weights —&gt; Lots of local minima! It results in lots of local minima because we are updating simultaneously all the weights</p>
<p>That means that the loss function depends on all the parameters (all the weights in the NN) thus we have a lot of parameters to update.</p>
<center>
<img src="imgs/2023-10-06-14-15-19.png" class="w400 img-fluid">
</center>
<pre></pre>
<p>Here for instance we have 2 local minima and one unique global minima</p>
</section>
<section id="neural-network-optimization-surface" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="neural-network-optimization-surface"><span class="header-section-number">8</span> Neural Network Optimization Surface</h2>
<center>
<img src="imgs/2023-10-06-14-17-19.png" class="w400 img-fluid">
</center>
<ul>
<li>Despite these crazy optimization landscapes, gradient descent works amazingly well!</li>
<li>For large networks, many of the critical points are saddle-points, not local minima.</li>
</ul>
<p>As our dimensionality increases, the saddle points will grow with respect to the minimum, but the minimam will also grow</p>
<center>
<img src="imgs/2023-10-06-14-52-54.png" class="w450 img-fluid">
</center>
<p>Because of all these variation we want to always report uncertainties on performance. This uncertainties comes from randomness in initialization and Stochastic Gradient Descend SGD.</p>
<p>The idea is to report error by averaging over all these models in the same column.</p>
<p>Now, we talked about making the learning rate higher at start and then slowly decreased it at training. This what we talk in the next topic:</p>
</section>
<section id="cyclic-learning-rates" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="cyclic-learning-rates"><span class="header-section-number">9</span> Cyclic Learning Rates</h2>
<p>It may seem crazy making the learning rate cyclic, so increase it again then lower it then increase it again. But this results in exploration so that you don’t end up in a local minima.</p>
<center>
<img src="imgs/2023-10-06-15-00-23.png" class="w475 img-fluid">
</center>
<center>
<img src="imgs/2023-10-06-15-01-07.png" class="w475 img-fluid">
</center>
<p>With cyclic learning rate we could explore three local minima</p>
<blockquote class="blockquote">
<p>Note: We used to compute Logistic Regression with Gradient Descent, here its the same with NN. More mathematically we cannot compute a closed form of the weights hence we use GD.</p>
</blockquote>
</section>
<section id="chain-rule-through-layers" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="chain-rule-through-layers"><span class="header-section-number">10</span> Chain Rule through Layers</h2>
<ul>
<li>Forward Propagation: is to evaluate the full network from inputs to ouputs</li>
<li>Backward Propagation: is to send error signals back though the network</li>
</ul>
<center>
<img src="imgs/2023-10-06-20-06-20.png" class="w400 img-fluid">
</center>
<p>Remember <span class="math inline">\(h_l = \sigma(a)\)</span>. Meaning the ouput of the sigmoid is the new <span class="math inline">\(h_l\)</span>. With this in mind because we want to tune the parameters aka weights we send the error back to the inputs, this as we said before it’s called backpropagation.</p>
<p>Now, because we want to send the error back so that we can reduce it, we would compute the derivative. Here is the same, we will compute the derivatives and because the NN its like a chain of multiplication due to the chain rule, here we can make use of optimization techniques. That is:</p>
<ul>
<li>Backpropagation is simply the chain rule implemented with cached values of intermediate computations.</li>
<li>We have the tradeoff between computational complexity for memory. In other words we have saved in computation complexity (carry out many derivatives) because we have cached these <span class="math inline">\(h_{l,j}\)</span> which is exactly the result of computing the derivatives to reduce the error and thus carry out backpropagation.</li>
</ul>
<p>In summary when we do backprogation due to the symmetry of the hidden layers, we can save in computing all the times the derivatives and instead trade it for memory to cache these <span class="math inline">\(h_{l,j}\)</span></p>
<p>The above is what distinguishes the chain rule from backpropagation. Backpropagation uses the notion of reusing information.</p>
<center>
<img src="imgs/2023-10-06-20-23-31.png" class="w350 img-fluid">
</center>
</section>
<section id="downside-numerical-issues" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="downside-numerical-issues"><span class="header-section-number">11</span> Downside: Numerical Issues</h2>
<center>
<img src="imgs/2023-10-06-20-27-49.png" class="w400 img-fluid">
</center>
<p>Two things can go wrong with this approach:</p>
<ol type="1">
<li><strong>Exploding gradients:</strong>
<ul>
<li><em>Problem:</em> The multiplication of an intermediate derivate value could be large so then wehn you continue multiplying with the rest of the layers then it will become a huge number.<br>
</li>
<li><em>Solution:</em> can usually be handled by ‘clipping’ values or regularizing weights to be small.</li>
</ul></li>
<li><strong>Vanishing gradients:</strong>
<ul>
<li><em>Problem:</em> When the ouput of the sigmoid is close to <span class="math inline">\(1\)</span> or <span class="math inline">\(0\)</span> we would have that the derivative <span class="math inline">\(h_{l,j}*(1-h_{l,j})\)</span> where recall that <span class="math inline">\(\textbf{h}_l=\sigma(\textbf{a})\)</span> meaning when sigmoid evaluates to this extremes then the derivative would become zero. In other words, if zero because <span class="math inline">\(h_{l,j}\)</span> can be <span class="math inline">\(1\)</span> or <span class="math inline">\(0\)</span> then all derivatives to earlier layers will be zero. See figure below:</li>
</ul>
<center>
<img src="imgs/2023-10-06-20-43-56.png" class="w400 img-fluid">
</center>
The figure above then means that if one derivative becomes zero then learning cannot happen.
<ul>
<li><em>Possible Solution1:</em> there is no proper solution because if you say you want to clip this derivative not to yield <span class="math inline">\(1\)</span> or <span class="math inline">\(0\)</span> then your next question its to how much close to these extremes I should set the derivative. (In practice however the sigmoid will not evaluate to perfect <span class="math inline">\(1\)</span> or <span class="math inline">\(0\)</span> but it will be small enough to make the multiplication of the other derivatives in the chain rule significantly deleterious to proceed training).<br>
</li>
<li><em>Possible Solution2:</em> In the neural networks we add a line that connect the current output layer <span class="math inline">\(h_l\)</span> with the previous outout layer <span class="math inline">\(h_{l-1}\)</span></li>
</ul></li>
</ol>
</section>
<section id="scalar-neural-network" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="scalar-neural-network"><span class="header-section-number">12</span> Scalar Neural Network</h2>
<center>
<img src="imgs/2023-10-07-01-16-22.png" class="w475 img-fluid">
</center>
<pre></pre>
<p>Recall that when we do linear regression we do not need to have an activation function <span class="math inline">\(f\)</span> like softmax or logistic, we just have the identity which means <span class="math inline">\(f(w_2 \cdot h)\)</span> becomes just <span class="math inline">\(w_2 \cdot h\)</span>.</p>
<center>
<img src="imgs/2023-10-07-01-18-20.png" class="w350 img-fluid">
</center>
<pre></pre>
<section id="computing-the-error-loss-on-w_1" class="level3" data-number="12.1">
<h3 data-number="12.1" class="anchored" data-anchor-id="computing-the-error-loss-on-w_1"><span class="header-section-number">12.1</span> Computing the Error loss on <span class="math inline">\(w_1\)</span></h3>
<center>
<img src="imgs/2023-10-07-01-18-41.png" class="w400 img-fluid">
</center>
<p>If we would compute the error but now with activation function <span class="math inline">\(a\)</span> equals <strong>Relu</strong></p>
<center>
<img src="imgs/2023-10-07-01-27-37.png" class="w350 img-fluid">
</center>
<p>This could be a bad idea because if <span class="math inline">\(w_1 \cdot x\)</span> is lower than <span class="math inline">\(0\)</span> then the whole error loss would be evaluated to zero and thus cannot train the network because you keep getting derivatives of zero. This is called the <em>Dead Relu problem</em>. In practice people initialize the input to a positive value. Also people use Leaky Relu depicted below</p>
<center>
<img src="imgs/2023-10-07-01-34-19.png" class="w450 img-fluid">
</center>
</section>
</section>
<section id="vector-neural-network" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="vector-neural-network"><span class="header-section-number">13</span> Vector Neural Network</h2>
<blockquote class="blockquote">
<p>We will have a <strong>scalar</strong> input and <strong>scalar</strong> ouput but with hidden layers as <strong>vectors</strong>.</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Derivative</strong> is a row vector: <span class="math display">\[
\begin{align}
\frac{\partial f}{\partial \textbf{x}} = \left[\frac{\partial f}{\partial x_1},...,\frac{\partial f}{\partial x_D} \right]
\end{align}
\]</span></li>
<li><strong>Gradient</strong> is the transpose of the Derivative vector: <span class="math display">\[
\begin{align}
\nabla_{w_1}f = \left[\frac{\partial f}{\partial \textbf{w}_1} \right]^T
\end{align}
\]</span> We do the transpose because we are tryng to get the same shape as our paramter <span class="math inline">\(\textbf{W}\)</span>. So in this case if <span class="math inline">\(W\)</span> would have been a two-row vector then with the transpose we ensure that.</li>
</ul>
</div>
</div>
</section>
<section id="computations-in-2d" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="computations-in-2d"><span class="header-section-number">14</span> Computations in 2D</h2>
<center>
<img src="imgs/2023-10-07-18-05-27.png" class="img-fluid">
</center>
<p>A rule of thumb is:</p>
<ul>
<li>Output linear operator <strong>Rows</strong></li>
<li>The model parameters as <strong>Columns</strong></li>
</ul>
<center>
<img src="imgs/2023-10-07-18-26-26.png" class="w475 img-fluid">
</center>
</section>
<section id="two-modes-forward-and-reverse" class="level2" data-number="15">
<h2 data-number="15" class="anchored" data-anchor-id="two-modes-forward-and-reverse"><span class="header-section-number">15</span> Two Modes: Forward and Reverse</h2>
<p>In Pytorch, you can compute the forward or reverse computation we saw before. The only difference is which direction you cache from.</p>
<ol type="1">
<li><strong>Forward mode:</strong> you start with the partial derivatives at the beginning of the NN. For instance in the image below, from dh1/dw1 (the first layer) to df/dh2 (the last layer).
<ul>
<li>Better when ouput dim &gt;&gt; input dim</li>
</ul></li>
</ol>
<center>
<img src="imgs/2023-10-07-18-33-51.png" class="w300 img-fluid">
</center>
<ol start="2" type="1">
<li><strong>Reverse mode:</strong> you start from the ouput to the input.
<ul>
<li>Better when ouput dim &lt;&lt; input dim</li>
</ul></li>
</ol>
<center>
<img src="imgs/2023-10-07-18-34-12.png" class="w300 img-fluid">
</center>
<pre></pre>
<p>This is telling us that i.e to be more <strong>efficient</strong> in an image classifier then you would prefer the <em>Reverse mode</em> because you have that your input would be a huge array of numbers whereas your ouput would be a few classes. So here it applies: dim ouput &lt;&lt; dim input.</p>
<p>The reason for ie in forward mode is that you would compute small derivatives because your input is small so then you delay to compute much more multiplication to the end</p>
<p>Another examples why is more efficient, say your outputs &gt;&gt; inputs, then if you start by computing the ouput derivatives then you are going to accumulate and carry all those dimensions due to the large ouput derivatives. Then you carry all these computations to the input layer that has fewer computations but you already have a hug baggage and its not efficient. <strong>Summary</strong>: you want to do the large multiplication until the end so that you do not carry unnecessary derivation.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.danilotpnta\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../about/index.html">
<p><span class="footerDaniloToapanta">© 2024 Danilo Toapanta</span></p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../privacy/index.html">
<p>Privacy</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../contact/index.html">
<p>Contact</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../license/index.html">
<p>License</p>
</a>
  </li>  
</ul>
    <div class="toc-actions"><ul><li><a href="https://github.com/danilotpnta/danilotpnta.github.io/blob/main/blog/2023-10-04_neural-networks/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/danilotpnta/danilotpnta.github.io/edit/main/blog/2023-10-04_neural-networks/index.qmd" class="toc-action"><i class="bi empty"></i>Edit this page</a></li><li><a href="https://github.com/danilotpnta/danilotpnta.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../docs/sitemap.xml">
      <i class="bi bi-rss-fill" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>

    let navbar = document.getElementsByClassName("navbar-nav")[0]    

    let li2 = document.createElement("li");
    li2.className = "nav-item compact";

    let a2 = document.createElement("a");
    a2.className = "nav-link quarto-color-scheme-toggle";
    a2.style.cursor = "pointer"
    li2.appendChild(a2)

    let i2 = document.createElement("i");
    i2.className = "bi bi-moon"
    a2.append(i2)

    navbar.appendChild(li2);

    i2.onclick = function() {
        window.quartoToggleColorScheme(); return false;
    }
    // <a href="http://localhost:4200/about/" class="quarto-color-scheme-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>

    let li = document.createElement("li");
    li.className = "nav-item compact";

    let a = document.createElement("a");
    a.className = "nav-link";
    a.style.cursor = "pointer"
    li.appendChild(a)

    let i = document.createElement("i");
    i.className = "bi bi-search"
    a.append(i)

    // let span = document.createElement("span");
    // span.className = "menu-text"
    // a.append(span)

    navbar.appendChild(li);

    a.onclick = function() {
        window.quartoOpenSearch()
    }


</script>






</body></html>