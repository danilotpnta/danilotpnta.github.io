<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Danilo Toapanta">
<meta name="dcterms.date" content="2023-11-20">
<meta name="description" content="Description of this Post">

<title>Convolutional Neural Networks – Danilo Toapanta</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/images/danilo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<!-- <link href="../../site_libs/quarto-contrib/material-icons-0.14.2/mi.css" rel="stylesheet"> -->
<script>
window.MathJax = {
  tex: {
    tags: 'ams'
  }
};
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../css/index-posts.css">
</head>

<body class="floating nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <div id="quarto-announcement" data-announcement-id="af66dd50c39dd2ed9de488e10a192054" class="alert alert-primary hidden"><i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p><strong>Let op</strong> - This website is undergoing scheduled maintenance</p>
</div></div>
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title"><span id="danilo_topanta_brand"> Danilo Toapanta</span> <a id="mysite" class="mysite" href="../../site-ver-hist/">v1.3</a></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text"><span id="home-welcome-msg">Home</span></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/danilotpnta?tab=repositories" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full blog-page" style="display: none !important;">
    <div class="quarto-title-banner page-columns page-full">
        <div class="quarto-title column-body">
            <h1 class="title">Convolutional Neural Networks</h1>
                
            <!-- Description Block -->
                        <div>
                <div class="description">
                    Description of this Post
                </div>
            </div>
                        
            <!-- Categories Block -->
                                            <div class="quarto-categories">

                    <!-- Display Categories -->
                                            <div class="quarto-category">
                            <a href="../../blog/#category=All">
                                All
                            </a>
                        </div> 
                                            <div class="quarto-category">
                            <a href="../../blog/#category=Deep Learning">
                                Deep Learning
                            </a>
                        </div> 
                                            <div class="quarto-category">
                            <a href="../../blog/#category=TAGS">
                                TAGS
                            </a>
                        </div> 
                    
                    <!-- Display Tags if any -->
                                    </div>
                            
        </div>
    </div>


    
    <div class="quarto-title-meta">

        <div>
        <div class="quarto-title-meta-heading">Author</div>
        <div class="quarto-title-meta-contents">
                 <p><a href="https://danilotpnta.github.io/">Danilo Toapanta</a> </p>
              </div>
      </div>
        
        <div>
        <div class="quarto-title-meta-heading">Published</div>
        <div class="quarto-title-meta-contents">
          <p class="date">November 20, 2023</p>
        </div>
      </div>
      
        
      </div>
      

    
</header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">
<script>
    var currentUrl = window.location.href;
    var index_init_post = currentUrl.lastIndexOf("/20");
    var string_init_post= currentUrl.slice(index_init_post, index_init_post+3 );

    // console.log("currentUrl: " + currentUrl);
    // console.log("index: " + index_init_post);
    // console.log("string: " + string_init_post);

    // If is equal to /blog/20... then make navbar title READING MODE
    if (string_init_post === "/20"){
        let mysite = document.getElementById("mysite");
        mysite.classList.add("mysite-change");

        let navbar = document.getElementById("danilo_topanta_brand");
        navbar.classList.add("navbar-brand-change");

        // This will render a new title saying READING DANILOS BLOG
        // navbar.innerHTML = 'You are Reading Danilo\'s Blog<span style="font-size:35px; vertical-align: middle; opacity: 0.65; padding-bottom: 6px; padding-left: 14px;" class="material-icons-round"> auto_awesome </span>';
        
        const smallDevice = window.matchMedia("(min-width: 570px)");
        smallDevice.addListener(handleDeviceChange);

        function handleDeviceChange(mediaQuery) {
            if (mediaQuery.matches) {
                navbar.innerHTML = "";
                // navbar.innerHTML = "<-- You are Reading Danilo's Blog -->";
            } else  {
                navbar.innerHTML = "Danilo Toapanta";
            }
        }

        // Run it initially
        handleDeviceChange(smallDevice);

        let link = document.getElementsByClassName("navbar-brand")[0];
        link.classList.add("disablePointerEvents");

        let brand_container = document.getElementsByClassName("navbar-brand-container")[0];
        brand_container.classList.add("navbar-brand-container-new-padding");

    }
</script>


<!-- <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Running my first Marathon</h1>
                  <div>
        <div class="description">
          I will be running at the 42km TCS Amsterdam 2023, 15th October
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">News</div>
              </div>
                  </div>
  </div> -->

  <!-- ---
  coming-soon: true
  tags: [Spanish]
  --- -->








<main id="title-block-header" class="quarto-title-block default page-columns page-full" style="padding-bottom: 40px;">

    <div class="quarto-title column-body" style="margin-bottom: 1em;">
        <h1 class="title" style="padding-bottom:8px" ;="">Convolutional Neural Networks</h1>
        
        <!-- Description Block -->
                    <div>
                <div class="description">
                    Description of this Post
                </div>
            </div>
        
        <!-- Categories Block -->
                    
                <!-- Display Categories -->
                <div class="quarto-categories">
                    <!-- <div id="tag-icon-blog" class="quarto-category tags-title">
                        <i class="fa-solid fa-hashtag" ></i> Categories:
                    </div> -->

                                            <div id="All" class="quarto-category">
                            <a href="../../blog/#category=All">
                                All
                            </a>
                        </div>
                                            <div id="Deep Learning" class="quarto-category">
                            <a href="../../blog/#category=Deep Learning">
                                Deep Learning
                            </a>
                        </div>
                                            <div id="TAGS" class="quarto-category">
                            <a href="../../blog/#category=TAGS">
                                TAGS
                            </a>
                        </div>
                                    </div>
                


                <div class="quarto-categories tag-categories">
                    
                    <!-- Tags Icon  -->
                    <!-- <div id="tag-icon-blog" class="quarto-category tags-title"> -->
                        <!-- <i class="fa-solid fa-tag" ></i> Tags: -->
                        <!-- <i class="fa-solid fa-hashtag" ></i> Tags: -->
                        <!-- <span class="material-icons-outlined" >local_offer</span> Tags: -->
                        <!-- / -->
                    <!-- </div> -->

                    <!-- Display Tags -->
                                            <div id="All-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=All">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                All
                            </a>
                        </div>
                                            <div id="Deep Learning-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=Deep Learning">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                Deep Learning
                            </a>
                        </div>
                                            <div id="TAGS-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=TAGS">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                TAGS
                            </a>
                        </div>
                    
                    
                </div>

                    
    </div>


    
    <div class="quarto-title-meta">

        <div>
        <div class="quarto-title-meta-heading">Author</div>
        <div class="quarto-title-meta-contents">
                 <p><a href="https://danilotpnta.github.io/">Danilo Toapanta</a> </p>
              </div>
      </div>
        
        <div>
        <div class="quarto-title-meta-heading">Published</div>
        <div class="quarto-title-meta-contents">
          <p class="date">November 20, 2023</p>
        </div>
      </div>
      
        
      </div>
      

    <!-- Current link: Font-awesome, Google icons, Bootstrap icons -->
    
</main>


<!-- ## Title
<center>![Slide 1](imgs/page_1.png){.w575}</center><pre></pre> -->
<section id="optimizing-neural-networks" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="optimizing-neural-networks"><span class="header-section-number">1</span> Optimizing neural networks</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_2.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 2</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="multi-layer-perceptrons-recap" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="multi-layer-perceptrons-recap"><span class="header-section-number">2</span> Multi-layer perceptrons (Recap)</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_3.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 3</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="multi-layer-perceptrons-recap-1" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="multi-layer-perceptrons-recap-1"><span class="header-section-number">3</span> Multi-layer perceptrons (Recap)</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_4.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 4</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Prior knowledge, is something that we know about the data, we want to bring this into the design of the NNs</p>
</section>
<section id="consider-an-image" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="consider-an-image"><span class="header-section-number">4</span> Consider an image</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_5.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 5</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="hubel-and-wiesel-nobel-prize-for-physiology-or-medicine-in-1981" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="hubel-and-wiesel-nobel-prize-for-physiology-or-medicine-in-1981"><span class="header-section-number">5</span> Hubel and Wiesel: Nobel Prize for Physiology or Medicine in 1981</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_6.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 6</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Here when we see edges, there is some electricity</p>
</section>
<section id="filters-yes.-how-about-learnable-filters" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="filters-yes.-how-about-learnable-filters"><span class="header-section-number">6</span> Filters, yes. How about learnable filters</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_7.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 7</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Canny and GAbor filters they all try to find edges, then it can be used for recognition purposes.</p>
</section>
<section id="filters-yes.-how-about-learnable-filters-1" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="filters-yes.-how-about-learnable-filters-1"><span class="header-section-number">7</span> Filters, yes. How about learnable filters</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_8.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 8</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="the-convolution-operation" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="the-convolution-operation"><span class="header-section-number">8</span> The convolution operation</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_9.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 9</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="the-convolution-operation-1" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="the-convolution-operation-1"><span class="header-section-number">9</span> The convolution operation</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_10.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 10</figcaption>
</figure>
</div>
</center>
<pre></pre>
<center>
<img src="imgs/2023-11-21-16-22-45.png" class="w350 img-fluid">
</center>
<pre></pre>
<center>
<img src="imgs/2023-11-21-16-23-47.png" class="w350 img-fluid">
</center>
<pre></pre>
<p>Here f*g is the convolution in red line. In the 1D case</p>
<p>Here g is the kernel</p>
</section>
<section id="convolution-for-2d-images" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="convolution-for-2d-images"><span class="header-section-number">10</span> Convolution for 2D images</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_11.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 11</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Now our kernel is 2D</p>
</section>
<section id="convolution-for-2d-images-1" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="convolution-for-2d-images-1"><span class="header-section-number">11</span> Convolution for 2D images</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_12.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 12</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="examples" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="examples"><span class="header-section-number">12</span> Examples</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_13.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 13</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="examples-1" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="examples-1"><span class="header-section-number">13</span> Examples</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_14.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 14</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Sobel fires for vertical edges</p>
</section>
<section id="quiz" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="quiz"><span class="header-section-number">14</span> Quiz</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_15.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 15</figcaption>
</figure>
</div>
</center>
<pre></pre>
<ol start="2" type="1">
<li>It will emphasize edges</li>
</ol>
<p>If you take a CNN and you have weights uniform then you would not have this edge detectors and the NN would not train well</p>
<p>This is like adding prior knowledge because we know edges are supper important to detect whether is a cat or a dog</p>
</section>
<section id="the-motivation-of-convolutions" class="level2" data-number="15">
<h2 data-number="15" class="anchored" data-anchor-id="the-motivation-of-convolutions"><span class="header-section-number">15</span> The motivation of convolutions</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_16.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 16</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Local connectivity, for ie if you want to detect edges, you dont need to look at the whole image and because you share the parameters, the weights are tied and you are more efficient.</p>
</section>
<section id="the-motivation-of-convolutions-1" class="level2" data-number="16">
<h2 data-number="16" class="anchored" data-anchor-id="the-motivation-of-convolutions-1"><span class="header-section-number">16</span> The motivation of convolutions</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_17.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 17</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>This saves quite a bit of neurons connected, so less parameters, this is the same as analysing an img of 16x16, but now instead we use filters so that we can detect edges and only with these edges we have now building blocks which are less than computing the whole image.</p>
<p>Here the kernel would be of width 3</p>
</section>
<section id="the-motivation-of-convolutions-2" class="level2" data-number="17">
<h2 data-number="17" class="anchored" data-anchor-id="the-motivation-of-convolutions-2"><span class="header-section-number">17</span> The motivation of convolutions</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_18.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 18</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>So here in the left the NN has a receptive field of size 3, because this is how much a neuron can look up, so it is the kernel size. But per layer the receptive field gradually grows which allow you to have a hierarchical structure</p>
<ul>
<li>For instance the neurons at layer 50 now they can see at the whole image and can put image into context. This is how you go from local to global</li>
</ul>
</section>
<section id="the-motivation-of-convolutions-3" class="level2" data-number="18">
<h2 data-number="18" class="anchored" data-anchor-id="the-motivation-of-convolutions-3"><span class="header-section-number">18</span> The motivation of convolutions</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_19.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 19</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="the-motivation-of-convolutions-4" class="level2" data-number="19">
<h2 data-number="19" class="anchored" data-anchor-id="the-motivation-of-convolutions-4"><span class="header-section-number">19</span> The motivation of convolutions</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_20.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 20</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>If the input shift then the outputs does the same, this is not the case for a fully connected NN</p>
</section>
<section id="a-simple-convolution-saves-space" class="level2" data-number="20">
<h2 data-number="20" class="anchored" data-anchor-id="a-simple-convolution-saves-space"><span class="header-section-number">20</span> A simple convolution: saves space!</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_21.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 21</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>The bigger the filter the more zeros we will have</p>
</section>
<section id="convolution-vs-pooling-in-2d" class="level2" data-number="21">
<h2 data-number="21" class="anchored" data-anchor-id="convolution-vs-pooling-in-2d"><span class="header-section-number">21</span> Convolution vs Pooling in 2D</h2>
<center>
<img src="imgs/2023-11-21-20-02-21.png" class="w550 img-fluid">
</center>
<pre></pre>
</section>
<section id="the-pooling-operations" class="level2" data-number="22">
<h2 data-number="22" class="anchored" data-anchor-id="the-pooling-operations"><span class="header-section-number">22</span> The pooling operations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_22.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 22</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Pooling functions are another way to incorporate prior knowledge. It aggregates the activations. This can be local or global</p>
<p>You can max pool, or average pool the activations in some rectangular neighborhood. It reduces the space size and improves the efficiency and it also increases robustness</p>
<p>It also incorporates invariance to translations, because it will not matter whether the 6 would be in that corner or so on so on</p>
<p>At the last step you could od average global pooling, and just have one vector out, and in this vector will be trained to represent the whole image. Here you could apply a fully connected layer if you care classification</p>
<p>Min, max all are differentiable. If you instead would have and argmax then it will not be differentiable</p>
<p>So pooling operations like the global ones, also allow you to be independent in which input image you feed into your NN</p>
</section>
<section id="lenet-5" class="level2" data-number="23">
<h2 data-number="23" class="anchored" data-anchor-id="lenet-5"><span class="header-section-number">23</span> LeNet-5</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_23.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 23</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Here you do not have global pooling so an img of 29x29 would not have worked</p>
<p>The hidden dimensionalities are called channels, and the pooling is applied to all channels. So pooling operations do not change dimensionality but change the spatial extent.</p>
<p>So each layer would have channels those are all the squares in a layer, pooling it is apploed to every channel and per channel it reduces its square matrix to a lower width and lower height</p>
<section id="more" class="level3" data-number="23.1">
<h3 data-number="23.1" class="anchored" data-anchor-id="more"><span class="header-section-number">23.1</span> More</h3>
<p>LeNet-5, a convolutional neural network architecture proposed by Yann LeCun and his collaborators in 1998, does not use global average pooling in its original design. LeNet-5 primarily relies on subsampling layers (pooling layers) and fully connected layers.</p>
<p>The typical structure of LeNet-5 consists of alternating convolutional layers with subsampling (pooling) layers, followed by fully connected layers. The pooling layers in LeNet-5 perform down-sampling through operations like max pooling. Global average pooling was not a commonly used technique at the time LeNet-5 was introduced.</p>
<p>Global average pooling became more prominent in later CNN architectures, such as Google’s Inception models and the popular ResNet architectures</p>
</section>
<section id="global-pooling" class="level3" data-number="23.2">
<h3 data-number="23.2" class="anchored" data-anchor-id="global-pooling"><span class="header-section-number">23.2</span> Global Pooling</h3>
<p>Global pooling (or global average pooling) is a technique used in convolutional neural networks (CNNs) to reduce the spatial dimensions of a feature map to a single value or a vector. It involves taking the average (or maximum) value across all spatial locations of each feature map, resulting in a global representation.</p>
<p>Here’s an example of global average pooling with Python using NumPy:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume you have a 3x3 feature map with 2 channels</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>feature_map <span class="op">=</span> np.array([</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    [[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]],</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    [[<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>], [<span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>], [<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>]]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply global average pooling</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>global_avg_pooled <span class="op">=</span> np.mean(feature_map, axis<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the original feature map and the result after global average pooling</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original Feature Map:"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_map)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Global Average Pooled Result:"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(global_avg_pooled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In this example, <code>feature_map</code> is a 3x3 feature map with 2 channels. The <code>np.mean</code> function is used to compute the average along the spatial dimensions (axis 0 and 1). The resulting <code>global_avg_pooled</code> is a vector representing the global average-pooled values for each channel.</p>
<p>The output should look like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Original Feature Map:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>[[[ <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  [ <span class="dv">4</span>  <span class="dv">5</span>  <span class="dv">6</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  [ <span class="dv">7</span>  <span class="dv">8</span>  <span class="dv">9</span>]]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a> [[<span class="dv">10</span> <span class="dv">11</span> <span class="dv">12</span>]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">13</span> <span class="dv">14</span> <span class="dv">15</span>]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">16</span> <span class="dv">17</span> <span class="dv">18</span>]]]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>Global Average Pooled Result:</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>[<span class="fl">8.5</span> <span class="fl">9.5</span> <span class="fl">10.5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In this case, the global average pooling operation has computed the average value for each channel across all spatial locations, resulting in a global representation for each channel. This global representation is often used as a compact and informative input to subsequent layers or for making predictions in the network.</p>
</section>
</section>
<section id="alexnet-similar-principles-but-some-extra-engineering." class="level2" data-number="24">
<h2 data-number="24" class="anchored" data-anchor-id="alexnet-similar-principles-but-some-extra-engineering."><span class="header-section-number">24</span> AlexNet: similar principles, but some extra engineering.</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_24.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 24</figcaption>
</figure>
</div>
</center>
<pre></pre>
<!-- ## Title -->
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_25.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 25</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Weight sharing in convolutional neural networks (CNNs) refers to the practice of using the same set of learnable parameters (weights and biases) for multiple units or neurons in a layer. In other words, the weights are shared across different spatial locations in the input.</p>
<p>The key idea behind weight sharing is to enforce translation invariance in the features learned by the convolutional layers. In an image, certain features (e.g., edges, textures) are meaningful regardless of their specific location. By using shared weights, the network can learn to detect these features at different spatial positions, leading to a more robust and generalizable representation.</p>
<p>Here’s a brief explanation of weight sharing in CNNs:</p>
<ol type="1">
<li><strong>Convolutional Operation:</strong>
<ul>
<li>In a convolutional layer, a set of filters (also known as kernels) is applied to the input image or feature map.</li>
<li>Each filter is characterized by a set of learnable weights and biases.</li>
</ul></li>
<li><strong>Spatial Weight Sharing:</strong>
<ul>
<li>Instead of having unique weights for each spatial location in the input, weight sharing involves using the same set of weights across different spatial locations.</li>
<li>For example, if a filter detects a certain feature (e.g., an edge) at one location, the same filter with the same weights can be used to detect the same feature at a different location.</li>
</ul></li>
<li><strong>Benefits:</strong>
<ul>
<li>Reduces the number of learnable parameters in the network, making it more computationally efficient.</li>
<li>Encourages the learning of spatially invariant features, enhancing the network’s ability to recognize patterns across different locations.</li>
</ul></li>
<li><strong>Translation Invariance:</strong>
<ul>
<li>Weight sharing helps the network achieve translation invariance, meaning that it can recognize features regardless of their position in the input.</li>
</ul></li>
</ol>
<section id="cnn-and-weight-sharing" class="level3" data-number="24.1">
<h3 data-number="24.1" class="anchored" data-anchor-id="cnn-and-weight-sharing"><span class="header-section-number">24.1</span> CNN and Weight Sharing</h3>
<p>CNN is primarily used for image classification and segmentation, and it works by finding similar patterns throughout the input. These patterns can be found by sliding a filter with shared weights across the input. The shared weights concept allows the network to learn the same pattern, regardless of its position in the input</p>
<!-- ## What shape should the
<center>![Slide 26](imgs/page_26.png){.w575}</center><pre></pre>



## What shape should the
<center>![Slide 27](imgs/page_27.png){.w575}</center><pre></pre> -->
</section>
</section>
<section id="what-shape-should-the" class="level2" data-number="25">
<h2 data-number="25" class="anchored" data-anchor-id="what-shape-should-the"><span class="header-section-number">25</span> What shape should the</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_28.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 28</figcaption>
</figure>
</div>
</center>
<pre></pre>
<!-- ## 3D Activations
<center>![Slide 29](imgs/page_29.png){.w575}</center><pre></pre> -->
</section>
<section id="d-activations" class="level2" data-number="26">
<h2 data-number="26" class="anchored" data-anchor-id="d-activations"><span class="header-section-number">26</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_30.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 30</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Instead of calling it RGB channels, we just call it channels</p>
<!-- ## 3D Activations
<center>![Slide 31](imgs/page_31.png){.w575}</center><pre></pre> -->
</section>
<section id="d-activations-1" class="level2" data-number="27">
<h2 data-number="27" class="anchored" data-anchor-id="d-activations-1"><span class="header-section-number">27</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_32.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 32</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Now the activations contain width and height and also depth.</p>
<p>The depth is govern by the hidden dimensionality of the NN</p>
<!-- ## 3D Activations
<center>![Slide 33](imgs/page_33.png){.w575}</center><pre></pre> -->
</section>
<section id="d-activations-2" class="level2" data-number="28">
<h2 data-number="28" class="anchored" data-anchor-id="d-activations-2"><span class="header-section-number">28</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_34.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 34</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="d-activations-3" class="level2" data-number="29">
<h2 data-number="29" class="anchored" data-anchor-id="d-activations-3"><span class="header-section-number">29</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_35.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 35</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Here this is a convolution kernel, with kernel size 5x5</p>
<p>Now our neuron has a kernel size of 5x5 weights and also x3 because it has 3 channels</p>
<p>So each Neuron as a 3D filter</p>
<!-- ## 3D Activations
<center>![Slide 36](imgs/page_36.png){.w575}</center><pre></pre> -->
<!-- ## 3D Activations
<center>![Slide 37](imgs/page_37.png){.w575}</center><pre></pre> -->
</section>
<section id="d-activations-4" class="level2" data-number="30">
<h2 data-number="30" class="anchored" data-anchor-id="d-activations-4"><span class="header-section-number">30</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_38.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 38</figcaption>
</figure>
</div>
</center>
<pre></pre>
<!-- <center>![](imgs/2023-11-21-19-51-29.png){.w300}</center><pre></pre>
<center>![](imgs/2023-11-21-19-51-51.png){.w575}</center><pre></pre> -->
<section id="example-not-moving-filter" class="level3" data-number="30.1">
<h3 data-number="30.1" class="anchored" data-anchor-id="example-not-moving-filter"><span class="header-section-number">30.1</span> Example: Not-moving Filter</h3>
<center>
<img src="imgs/2023-11-21-20-38-41.png" class="w300 img-fluid">
</center>
<pre></pre>
<p>Here we have:</p>
<ul>
<li>Input Layer: 3x32x32</li>
<li>Kernel 5-size: 3x5x5</li>
</ul>
<p>If we do not slide the filter then we are gonna end up with:</p>
<ul>
<li>Pre-output: 3x1x1 (three scalar values per each channel)</li>
</ul>
<p>Now we do a summation over the three channels and we have thus:</p>
<ul>
<li>Output: 1x1x1</li>
</ul>
</section>
<section id="example-sliding-filter" class="level3" data-number="30.2">
<h3 data-number="30.2" class="anchored" data-anchor-id="example-sliding-filter"><span class="header-section-number">30.2</span> Example: Sliding Filter</h3>
<p><img src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*Emy_ai48XaOeGDgykLypPg.gif" class="img-fluid"> <img src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*5otecXBNlms3lslqlYworA.gif" class="img-fluid" alt="Source: link"></p>
<p>Imagine now that we slide this 3D filter along all the input layer, then we end up:</p>
<ul>
<li>Pre-ouput: 3x(28)x(28), where we compute (width - kernel_size + 1) = (32-5+1)</li>
</ul>
<p>Now we sum over all three channel element wise and end up with:</p>
<ul>
<li>Output: 1x28x28</li>
</ul>
<!-- ## 3D Activations
<center>![Slide 39](imgs/page_39.png){.w575}</center><pre></pre> -->
<!-- ## 3D Activations
<center>![Slide 40](imgs/page_40.png){.w575}</center><pre></pre> -->
<!-- ## 3D Activations
<center>![Slide 41](imgs/page_41.png){.w575}</center><pre></pre> -->
</section>
</section>
<section id="d-activations-5" class="level2" data-number="31">
<h2 data-number="31" class="anchored" data-anchor-id="d-activations-5"><span class="header-section-number">31</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_42.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 42</figcaption>
</figure>
</div>
</center>
<pre></pre>
<!-- ## 3D Activations
<center>![Slide 43](imgs/page_43.png){.w575}</center><pre></pre> -->
</section>
<section id="d-activations-6" class="level2" data-number="32">
<h2 data-number="32" class="anchored" data-anchor-id="d-activations-6"><span class="header-section-number">32</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_44.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 44</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="d-activations-7" class="level2" data-number="33">
<h2 data-number="33" class="anchored" data-anchor-id="d-activations-7"><span class="header-section-number">33</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_45.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 45</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>If you now slide the filter with as many neurons we will get:</p>
<ul>
<li>Ouput: depth x (<span class="math inline">\(l\)</span>) x (<span class="math inline">\(l\)</span>)</li>
</ul>
<p>Where <span class="math inline">\(l\)</span> = width - kernel_size + 1</p>
<!-- ## 3D Activations
<center>![Slide 46](imgs/page_46.png){.w575}</center><pre></pre> -->
</section>
<section id="d-activations-8" class="level2" data-number="34">
<h2 data-number="34" class="anchored" data-anchor-id="d-activations-8"><span class="header-section-number">34</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_47.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 47</figcaption>
</figure>
</div>
</center>
<pre></pre>
<!-- ## 3D Activations
<center>![Slide 48](imgs/page_48.png){.w575}</center><pre></pre> -->
<!-- ## 31) Activations
<center>![Slide 49](imgs/page_49.png){.w575}</center><pre></pre> -->
</section>
<section id="d-activations-9" class="level2" data-number="35">
<h2 data-number="35" class="anchored" data-anchor-id="d-activations-9"><span class="header-section-number">35</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_50.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 50</figcaption>
</figure>
</div>
</center>
<pre></pre>
<!-- ## 3D Activations
<center>![Slide 51](imgs/page_51.png){.w575}</center><pre></pre> -->
</section>
<section id="d-activations-10" class="level2" data-number="36">
<h2 data-number="36" class="anchored" data-anchor-id="d-activations-10"><span class="header-section-number">36</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_52.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 52</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="d-activations-11" class="level2" data-number="37">
<h2 data-number="37" class="anchored" data-anchor-id="d-activations-11"><span class="header-section-number">37</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_53.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 53</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="d-activations-12" class="level2" data-number="38">
<h2 data-number="38" class="anchored" data-anchor-id="d-activations-12"><span class="header-section-number">38</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_54.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 54</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="d-activations-13" class="level2" data-number="39">
<h2 data-number="39" class="anchored" data-anchor-id="d-activations-13"><span class="header-section-number">39</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_55.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 55</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="d-activations-14" class="level2" data-number="40">
<h2 data-number="40" class="anchored" data-anchor-id="d-activations-14"><span class="header-section-number">40</span> 3D Activations</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_56.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 56</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="putting-it-together" class="level2" data-number="41">
<h2 data-number="41" class="anchored" data-anchor-id="putting-it-together"><span class="header-section-number">41</span> Putting it together</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_57.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 57</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="putting-it-together-1" class="level2" data-number="42">
<h2 data-number="42" class="anchored" data-anchor-id="putting-it-together-1"><span class="header-section-number">42</span> Putting it together</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_58.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 58</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="putting-it-together-2" class="level2" data-number="43">
<h2 data-number="43" class="anchored" data-anchor-id="putting-it-together-2"><span class="header-section-number">43</span> Putting it together</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_59.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 59</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="putting-it-together-3" class="level2" data-number="44">
<h2 data-number="44" class="anchored" data-anchor-id="putting-it-together-3"><span class="header-section-number">44</span> Putting it together</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_60.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 60</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="putting-it-together-4" class="level2" data-number="45">
<h2 data-number="45" class="anchored" data-anchor-id="putting-it-together-4"><span class="header-section-number">45</span> Putting it together</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_61.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 61</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="putting-it-together-5" class="level2" data-number="46">
<h2 data-number="46" class="anchored" data-anchor-id="putting-it-together-5"><span class="header-section-number">46</span> Putting it together</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_62.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 62</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="putting-it-together-6" class="level2" data-number="47">
<h2 data-number="47" class="anchored" data-anchor-id="putting-it-together-6"><span class="header-section-number">47</span> Putting it together</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_63.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 63</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="putting-it-together-7" class="level2" data-number="48">
<h2 data-number="48" class="anchored" data-anchor-id="putting-it-together-7"><span class="header-section-number">48</span> Putting it together</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_64.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 64</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Here all these coloured layers in the cube are filters which are neurons. All these neurons act only in one hidden layer8</p>
</section>
<section id="convolution-stride" class="level2" data-number="49">
<h2 data-number="49" class="anchored" data-anchor-id="convolution-stride"><span class="header-section-number">49</span> Convolution: Stride</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_65.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 65</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="convolution-stride-1" class="level2" data-number="50">
<h2 data-number="50" class="anchored" data-anchor-id="convolution-stride-1"><span class="header-section-number">50</span> Convolution: Stride</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_66.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 66</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="convolution-stride-2" class="level2" data-number="51">
<h2 data-number="51" class="anchored" data-anchor-id="convolution-stride-2"><span class="header-section-number">51</span> Convolution: Stride</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_67.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 67</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="convolution-stride-3" class="level2" data-number="52">
<h2 data-number="52" class="anchored" data-anchor-id="convolution-stride-3"><span class="header-section-number">52</span> Convolution: Stride</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_68.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 68</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="convolution-stride-4" class="level2" data-number="53">
<h2 data-number="53" class="anchored" data-anchor-id="convolution-stride-4"><span class="header-section-number">53</span> Convolution: Stride</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_69.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 69</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="convolution-stride-5" class="level2" data-number="54">
<h2 data-number="54" class="anchored" data-anchor-id="convolution-stride-5"><span class="header-section-number">54</span> Convolution: Stride</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_70.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 70</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="convolution-stride-6" class="level2" data-number="55">
<h2 data-number="55" class="anchored" data-anchor-id="convolution-stride-6"><span class="header-section-number">55</span> Convolution: Stride</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_71.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 71</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>In each time sum across channels because if you want to detect something you want to use all the colors, all the incoming channels</p>
<p>So each convolution sums all channels like in RGB, because you dont want a filter that only looks at blue, one that only looks at red ..</p>
</section>
<section id="convolution-stride-7" class="level2" data-number="56">
<h2 data-number="56" class="anchored" data-anchor-id="convolution-stride-7"><span class="header-section-number">56</span> Convolution: Stride</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_72.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 72</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Here in the next slide we see that <strong>stride</strong> is the number of squares that are moved, so the kernel filter will i.e stride=3 will slide every two squares</p>
</section>
<section id="convolution-stride-8" class="level2" data-number="57">
<h2 data-number="57" class="anchored" data-anchor-id="convolution-stride-8"><span class="header-section-number">57</span> Convolution: Stride</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_73.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 73</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="convolution-stride-9" class="level2" data-number="58">
<h2 data-number="58" class="anchored" data-anchor-id="convolution-stride-9"><span class="header-section-number">58</span> Convolution: Stride</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_74.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 74</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="convolution-stride-10" class="level2" data-number="59">
<h2 data-number="59" class="anchored" data-anchor-id="convolution-stride-10"><span class="header-section-number">59</span> Convolution: Stride</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_75.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 75</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="convolution-padding" class="level2" data-number="60">
<h2 data-number="60" class="anchored" data-anchor-id="convolution-padding"><span class="header-section-number">60</span> Convolution: Padding</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_76.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 76</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="convolution-padding-1" class="level2" data-number="61">
<h2 data-number="61" class="anchored" data-anchor-id="convolution-padding-1"><span class="header-section-number">61</span> Convolution: Padding</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_77.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 77</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="convolution-padding-2" class="level2" data-number="62">
<h2 data-number="62" class="anchored" data-anchor-id="convolution-padding-2"><span class="header-section-number">62</span> Convolution: Padding</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_78.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 78</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="convolution-padding-3" class="level2" data-number="63">
<h2 data-number="63" class="anchored" data-anchor-id="convolution-padding-3"><span class="header-section-number">63</span> Convolution: Padding</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_79.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 79</figcaption>
</figure>
</div>
</center>
<pre></pre>
<!-- ## Convolution:
<center>![Slide 80](imgs/page_80.png){.w575}</center><pre></pre> -->
</section>
<section id="convolution" class="level2" data-number="64">
<h2 data-number="64" class="anchored" data-anchor-id="convolution"><span class="header-section-number">64</span> Convolution:</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_81.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 81</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>W_out is what you get in the ouput layer of the slide (so for one filter)</p>
</section>
<section id="x1-convolution" class="level2" data-number="65">
<h2 data-number="65" class="anchored" data-anchor-id="x1-convolution"><span class="header-section-number">65</span> 1x1 Convolution</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_82.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 82</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>It looks at all the values in the depth, so in RGB, or more importantly in deep NNs the different hidden layers and they just mixed those information together</p>
</section>
<section id="x1-convolution-a-computationally-cheap-method" class="level2" data-number="66">
<h2 data-number="66" class="anchored" data-anchor-id="x1-convolution-a-computationally-cheap-method"><span class="header-section-number">66</span> 1x1 Convolution: a computationally cheap method</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_83.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 83</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Here in the 5x5x32 the convolution will be done over the 192 channels, 32 times (because we have 32 filters as depth), so sliding the filter a lot</p>
<p>In the bottom case we reduce the number of channels so now we reduce computations</p>
</section>
<section id="quiz-1" class="level2" data-number="67">
<h2 data-number="67" class="anchored" data-anchor-id="quiz-1"><span class="header-section-number">67</span> Quiz:</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_84.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 84</figcaption>
</figure>
</div>
</center>
<pre></pre>
<ol type="1">
<li></li>
</ol>
<ul>
<li>In the case of a fully connected layer, it connects everything in the layer. And even the 1x1 convolution it takes the full input dimensionality meaning it takes a look at all 192 channels still. In the 1x1 it reduces the number of connections comparing to fully connected and also it mixes local information</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
More differences:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>A 1x1 convolutional layer and a fully-connected layer (dense layer) are similar in that they both perform a linear transformation on the input data, but there are key differences between the two.</p>
<section id="x1-convolutional-layer" class="level3" data-number="67.1">
<h3 data-number="67.1" class="anchored" data-anchor-id="x1-convolutional-layer"><span class="header-section-number">67.1</span> 1x1 Convolutional Layer:</h3>
<ol type="1">
<li><strong>Spatial Information:</strong>
<ul>
<li>A 1x1 convolutional layer operates on spatial information in the input tensor.</li>
<li>It applies convolutional filters with a size of 1x1, which means it processes information at individual spatial locations.</li>
<li>Useful for capturing relationships between channels but does not capture spatial patterns.</li>
</ul></li>
<li><strong>Parameter Sharing:</strong>
<ul>
<li>Utilizes parameter sharing, similar to larger convolutional layers.</li>
<li>Each element in the output is the result of a weighted sum of its input elements, considering all channels.</li>
</ul></li>
<li><strong>Output Dimensions:</strong>
<ul>
<li>The output dimensions depend on the number of 1x1 filters used.</li>
</ul></li>
</ol>
</section>
<section id="fully-connected-layer" class="level3" data-number="67.2">
<h3 data-number="67.2" class="anchored" data-anchor-id="fully-connected-layer"><span class="header-section-number">67.2</span> Fully-Connected Layer:</h3>
<ol type="1">
<li><strong>Flattening:</strong>
<ul>
<li>A fully-connected layer operates on the flattened version of the input.</li>
<li>It considers all elements in the input tensor as individual input features.</li>
</ul></li>
<li><strong>Parameter Sharing:</strong>
<ul>
<li>Each neuron in a fully-connected layer has its set of weights for every input feature.</li>
<li>No parameter sharing between different neurons.</li>
</ul></li>
<li><strong>Output Dimensions:</strong>
<ul>
<li>The output dimensions are determined by the number of neurons in the layer.</li>
</ul></li>
</ol>
</section>
<section id="differences" class="level3" data-number="67.3">
<h3 data-number="67.3" class="anchored" data-anchor-id="differences"><span class="header-section-number">67.3</span> Differences:</h3>
<ol type="1">
<li><strong>Spatial vs.&nbsp;Global Information:</strong>
<ul>
<li>1x1 convolutional layers capture spatial information within each channel.</li>
<li>Fully-connected layers operate on global information, considering all elements as individual features.</li>
</ul></li>
<li><strong>Parameter Sharing:</strong>
<ul>
<li>1x1 convolutions use parameter sharing, making them more efficient for processing spatially correlated features.</li>
<li>Fully-connected layers lack parameter sharing, resulting in a larger number of parameters.</li>
</ul></li>
<li><strong>Computational Efficiency:</strong>
<ul>
<li>1x1 convolutions are computationally more efficient than fully-connected layers, especially in scenarios with spatially structured data.</li>
</ul></li>
<li><strong>Usage in Convolutional Networks:</strong>
<ul>
<li>1x1 convolutions are commonly used in convolutional neural networks (CNNs) to adjust the number of channels and perform feature transformations.</li>
<li>Fully-connected layers are typically used in the final layers of a neural network for classification.</li>
</ul></li>
</ol>
</section>
</div>
</div>
</div>
<ol start="2" type="1">
<li></li>
</ol>
<ul>
<li>You dont loss necessarily information, we do not want to do it at the beginning because mixing, red, blue and green per pixel does not do much. It makes sense to do it later if you have edges on top of edges and then you mix this information, it makes more sense.<br>
</li>
<li>It is also not good to apply 1x1 when you do <strong>not</strong> want translation invariance</li>
<li>every 1x1 is strictly local, every neuron as a receptive field so there is actually spatial information there</li>
</ul>
</section>
<section id="dilated-convolutions" class="level2" data-number="68">
<h2 data-number="68" class="anchored" data-anchor-id="dilated-convolutions"><span class="header-section-number">68</span> Dilated Convolutions</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_85.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 85</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>This is very usefull if you need to deal with a huge image, but dont want huge hidden activations</p>
<p>If you do this then you can quickly downscale the image, without ignoring too many things</p>
<p>Also think that dilation its less expensive because doing 5x5 its more expensive than doing 3x3, so you can learn 3x3 but with holes in between and that is more efficient to consider large spatial footprint</p>
</section>
<section id="pooling" class="level2" data-number="69">
<h2 data-number="69" class="anchored" data-anchor-id="pooling"><span class="header-section-number">69</span> Pooling</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_86.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 86</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="pooling-1" class="level2" data-number="70">
<h2 data-number="70" class="anchored" data-anchor-id="pooling-1"><span class="header-section-number">70</span> Pooling</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_87.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 87</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="max-pooling" class="level2" data-number="71">
<h2 data-number="71" class="anchored" data-anchor-id="max-pooling"><span class="header-section-number">71</span> Max Pooling</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_88.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 88</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="getting-rid-of-pooling" class="level2" data-number="72">
<h2 data-number="72" class="anchored" data-anchor-id="getting-rid-of-pooling"><span class="header-section-number">72</span> Getting rid of pooling</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_89.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 89</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Instead of using pooling you can use a larger stride (so how many squares we slide) that we talk about</p>
<p>In Transformers pooling it is also not used anymore</p>
<p>In CNN is used</p>
<!-- ## Example ConvNet
<center>![Slide 90](imgs/page_90.png){.w575}</center><pre></pre>



## Example ConvNet
<center>![Slide 91](imgs/page_91.png){.w575}</center><pre></pre> -->
<!-- ## Example ConvNet
<center>![Slide 92](imgs/page_92.png){.w575}</center><pre></pre> -->
</section>
<section id="example-convnet" class="level2" data-number="73">
<h2 data-number="73" class="anchored" data-anchor-id="example-convnet"><span class="header-section-number">73</span> Example ConvNet</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_93.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 93</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Every filter is one row here</p>
</section>
<section id="quiz-2" class="level2" data-number="74">
<h2 data-number="74" class="anchored" data-anchor-id="quiz-2"><span class="header-section-number">74</span> Quiz</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_94.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 94</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>If you choose the kernel size to be the same as the input image then it is fully connected.</p>
<p>Mathematically 1</p>
<p>Implementation wise 2</p>
</section>
<section id="how-research-gets-done-part-4" class="level2" data-number="75">
<h2 data-number="75" class="anchored" data-anchor-id="how-research-gets-done-part-4"><span class="header-section-number">75</span> How research gets done part 4</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_95.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 95</figcaption>
</figure>
</div>
</center>
<pre></pre>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_96.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 96</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="alexnet" class="level2" data-number="76">
<h2 data-number="76" class="anchored" data-anchor-id="alexnet"><span class="header-section-number">76</span> AlexNet</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_97.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 97</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="alexnet-1" class="level2" data-number="77">
<h2 data-number="77" class="anchored" data-anchor-id="alexnet-1"><span class="header-section-number">77</span> AlexNet</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_98.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 98</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="activation-function" class="level2" data-number="78">
<h2 data-number="78" class="anchored" data-anchor-id="activation-function"><span class="header-section-number">78</span> Activation function</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_99.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 99</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Faster to train because of simple Relu, and also the gradients are not vanishing because you have the gradient of 1 starting from the positive direction</p>
<p>Why does gradient do not vanish with Relu?</p>
<p>The vanishing gradient problem refers to the issue where the gradients of the loss function with respect to the weights become extremely small during backpropagation, making it challenging for the model to learn and update its parameters effectively. This problem is particularly associated with activation functions that squash their input into a small range, such as the sigmoid or hyperbolic tangent (tanh) functions.</p>
<p>ReLU (Rectified Linear Unit), on the other hand, has a non-saturating activation behavior, which means that it does not squash its input into a small range.</p>
<p>ReLU does not saturate in the positive region of its input. For positive input values, the gradient remains constant (1), leading to consistent and non-vanishing gradients during backpropagation.</p>
</section>
<section id="activation-function-1" class="level2" data-number="79">
<h2 data-number="79" class="anchored" data-anchor-id="activation-function-1"><span class="header-section-number">79</span> Activation function</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_100.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 100</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="training-with-multiple-gpus" class="level2" data-number="80">
<h2 data-number="80" class="anchored" data-anchor-id="training-with-multiple-gpus"><span class="header-section-number">80</span> Training with multiple GPUs</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_101.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 101</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="training-with-multiple-gpus-1" class="level2" data-number="81">
<h2 data-number="81" class="anchored" data-anchor-id="training-with-multiple-gpus-1"><span class="header-section-number">81</span> Training with multiple GPUs</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_102.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 102</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="on-that-note-communicating-between-gpus-pytorch" class="level2" data-number="82">
<h2 data-number="82" class="anchored" data-anchor-id="on-that-note-communicating-between-gpus-pytorch"><span class="header-section-number">82</span> On that note: Communicating between GPUs: PyTorch</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_103.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 103</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="local-response-normalization" class="level2" data-number="83">
<h2 data-number="83" class="anchored" data-anchor-id="local-response-normalization"><span class="header-section-number">83</span> Local Response Normalization</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_104.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 104</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="overlapping-pooling" class="level2" data-number="84">
<h2 data-number="84" class="anchored" data-anchor-id="overlapping-pooling"><span class="header-section-number">84</span> Overlapping Pooling</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_105.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 105</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="overlapping-pooling-1" class="level2" data-number="85">
<h2 data-number="85" class="anchored" data-anchor-id="overlapping-pooling-1"><span class="header-section-number">85</span> Overlapping Pooling</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_106.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 106</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="overall-architecture" class="level2" data-number="86">
<h2 data-number="86" class="anchored" data-anchor-id="overall-architecture"><span class="header-section-number">86</span> Overall architecture</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_107.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 107</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>The max pooling make a vector per every image</p>
</section>
<section id="the-overfitting-problem" class="level2" data-number="87">
<h2 data-number="87" class="anchored" data-anchor-id="the-overfitting-problem"><span class="header-section-number">87</span> The Overfitting Problem</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_108.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 108</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p><strong>If a have a cnn that has many parameter more than my data input will i overfit?</strong></p>
<p>If your CNN has a large number of parameters (i.e., it’s a complex model) and you have a small dataset, there is an increased risk of overfitting. A complex model may have the capacity to memorize the training data, capturing noise and outliers instead of learning generalizable patterns.</p>
<p>Althoug all these increase training time but high performance</p>
</section>
<section id="the-learned-filters" class="level2" data-number="88">
<h2 data-number="88" class="anchored" data-anchor-id="the-learned-filters"><span class="header-section-number">88</span> The learned filters</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_109.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 109</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="removing-layer-7" class="level2" data-number="89">
<h2 data-number="89" class="anchored" data-anchor-id="removing-layer-7"><span class="header-section-number">89</span> Removing layer 7</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_110.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 110</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="removing-layer-6-7" class="level2" data-number="90">
<h2 data-number="90" class="anchored" data-anchor-id="removing-layer-6-7"><span class="header-section-number">90</span> Removing layer 6, 7</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_111.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 111</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="removing-layer-3-4" class="level2" data-number="91">
<h2 data-number="91" class="anchored" data-anchor-id="removing-layer-3-4"><span class="header-section-number">91</span> Removing layer 3, 4</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_112.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 112</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>We dont save that much parameters because convolutional layers are more efficient (they are not fully connected, not too many parameters)</p>
</section>
<section id="removing-layer-3-4-6-7" class="level2" data-number="92">
<h2 data-number="92" class="anchored" data-anchor-id="removing-layer-3-4-6-7"><span class="header-section-number">92</span> Removing layer 3, 4, 6, 7</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_113.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 113</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="translation-invariance" class="level2" data-number="93">
<h2 data-number="93" class="anchored" data-anchor-id="translation-invariance"><span class="header-section-number">93</span> Translation invariance</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_114.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 114</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Despite saying that CNN tend to be equivariant which means if you shift the input the output should also shift you can see that if you do that with these images, where you are just shifting the images the outputs do vary quite a lot</p>
<p>So CNN do not learn something that is explicit symmetrical or explicitly equivariant. Equivariance may be a good prior that we put in, but that does not mean that that really happens</p>
</section>
<section id="scale-invariance" class="level2" data-number="94">
<h2 data-number="94" class="anchored" data-anchor-id="scale-invariance"><span class="header-section-number">94</span> Scale invariance</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_115.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 115</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Same with scale, we have said that we apply the pooling operations so therefore we can be a bit invariant to scaling, but still NNs tend not to be super scale invariant</p>
</section>
<section id="rotation-invariance" class="level2" data-number="95">
<h2 data-number="95" class="anchored" data-anchor-id="rotation-invariance"><span class="header-section-number">95</span> Rotation invariance</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_116.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 116</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="further-reading" class="level2" data-number="96">
<h2 data-number="96" class="anchored" data-anchor-id="further-reading"><span class="header-section-number">96</span> Further reading</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_117.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 117</figcaption>
</figure>
</div>
</center>
<pre></pre>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_118.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 118</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="transfer-learning-carry-benefits-from-large-dataset-to-the-small-one" class="level2" data-number="97">
<h2 data-number="97" class="anchored" data-anchor-id="transfer-learning-carry-benefits-from-large-dataset-to-the-small-one"><span class="header-section-number">97</span> Transfer learning: carry benefits from large dataset to the small one!</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_119.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 119</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="update-transfer-learning" class="level2" data-number="98">
<h2 data-number="98" class="anchored" data-anchor-id="update-transfer-learning"><span class="header-section-number">98</span> UPDATE: Transfer learning</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_120.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 120</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="why-use-transfer-learning" class="level2" data-number="99">
<h2 data-number="99" class="anchored" data-anchor-id="why-use-transfer-learning"><span class="header-section-number">99</span> Why use Transfer Learning?</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_121.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 121</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>The answer is yes even if you have saved the weights from a extremely good model and you have a small dataset</p>
</section>
<section id="convnets-are-good-in-transfer-learning" class="level2" data-number="100">
<h2 data-number="100" class="anchored" data-anchor-id="convnets-are-good-in-transfer-learning"><span class="header-section-number">100</span> Convnets are good in transfer learning</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_122.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 122</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Fine Tune the whole NN</p>
<p>Or use the CNN as feature extractor</p>
</section>
<section id="solution-i-fine-tune-ht-using-hs-as-initialization" class="level2" data-number="101">
<h2 data-number="101" class="anchored" data-anchor-id="solution-i-fine-tune-ht-using-hs-as-initialization"><span class="header-section-number">101</span> Solution I: Fine-tune hT using hS as initialization</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_123.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 123</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="initializing-ht-with-hs" class="level2" data-number="102">
<h2 data-number="102" class="anchored" data-anchor-id="initializing-ht-with-hs"><span class="header-section-number">102</span> Initializing hT with hS</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_124.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 124</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>Imagnet, it outputs 1000 categories. If you want to classification for 30 categories then you need to throw that one away and restart training a new classifier to your needs</p>
<p>AlexNet, you can start removing some layers depending on how much data you have</p>
</section>
<section id="initializing-ht-with-hs-1" class="level2" data-number="103">
<h2 data-number="103" class="anchored" data-anchor-id="initializing-ht-with-hs-1"><span class="header-section-number">103</span> Initializing hT with hS</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_125.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 125</figcaption>
</figure>
</div>
</center>
<pre></pre>
<p>if you pertained your NN in ImgNet and now you want to do Satalite classification then it may be usefull to find tune even those layers the bottom ones</p>
</section>
<section id="how-to-fine-tune" class="level2" data-number="104">
<h2 data-number="104" class="anchored" data-anchor-id="how-to-fine-tune"><span class="header-section-number">104</span> How to fine-tune?</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_126.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 126</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="solution-ii-use-hs-as-a-feature-extractor-for-ht" class="level2" data-number="105">
<h2 data-number="105" class="anchored" data-anchor-id="solution-ii-use-hs-as-a-feature-extractor-for-ht"><span class="header-section-number">105</span> Solution II: Use hS, as a feature extractor for hT</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_127.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 127</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="transfer-learning-benchmarks-techniques" class="level2" data-number="106">
<h2 data-number="106" class="anchored" data-anchor-id="transfer-learning-benchmarks-techniques"><span class="header-section-number">106</span> Transfer learning benchmarks &amp; techniques</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_128.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 128</figcaption>
</figure>
</div>
</center>
<pre></pre>
</section>
<section id="title" class="level2" data-number="107">
<h2 data-number="107" class="anchored" data-anchor-id="title"><span class="header-section-number">107</span> Title</h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/page_129.png" class="w575 img-fluid figure-img"></p>
<figcaption>Slide 129</figcaption>
</figure>
</div>
</center>
<pre></pre>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.danilotpnta\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../about/index.html">
<p><span class="footerDaniloToapanta">© 2024 Danilo Toapanta</span></p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../privacy/index.html">
<p>Privacy</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../contact/index.html">
<p>Contact</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../license/index.html">
<p>License</p>
</a>
  </li>  
</ul>
    <div class="toc-actions"><ul><li><a href="https://github.com/danilotpnta/danilotpnta.github.io/blob/main/blog/2023-11-20_convolutional-neural-networks/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/danilotpnta/danilotpnta.github.io/edit/main/blog/2023-11-20_convolutional-neural-networks/index.qmd" class="toc-action"><i class="bi empty"></i>Edit this page</a></li><li><a href="https://github.com/danilotpnta/danilotpnta.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../docs/sitemap.xml">
      <i class="bi bi-rss-fill" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>

    let navbar = document.getElementsByClassName("navbar-nav")[0]    

    let li2 = document.createElement("li");
    li2.className = "nav-item compact";

    let a2 = document.createElement("a");
    a2.className = "nav-link quarto-color-scheme-toggle";
    a2.style.cursor = "pointer"
    li2.appendChild(a2)

    let i2 = document.createElement("i");
    i2.className = "bi bi-moon"
    a2.append(i2)

    navbar.appendChild(li2);

    i2.onclick = function() {
        window.quartoToggleColorScheme(); return false;
    }
    // <a href="http://localhost:4200/about/" class="quarto-color-scheme-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>

    let li = document.createElement("li");
    li.className = "nav-item compact";

    let a = document.createElement("a");
    a.className = "nav-link";
    a.style.cursor = "pointer"
    li.appendChild(a)

    let i = document.createElement("i");
    i.className = "bi bi-search"
    a.append(i)

    // let span = document.createElement("span");
    // span.className = "menu-text"
    // a.append(span)

    navbar.appendChild(li);

    a.onclick = function() {
        window.quartoOpenSearch()
    }


</script>






</body></html>