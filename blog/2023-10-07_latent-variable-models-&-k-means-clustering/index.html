<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Danilo Toapanta">
<meta name="dcterms.date" content="2023-10-07">
<meta name="description" content="Lecture Notes UvA on 2-10-2023">

<title>Danilo Toapanta - Latent Variable Models &amp; K-Means Clustering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/danilo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/material-icons-0.14.2/mi.css" rel="stylesheet">
<script>
window.MathJax = {
  tex: {
    tags: 'ams'
  }
};
</script>
<link rel="shortcut icon" href="../../../../../../../../../../../assets/danilo.ico">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../css/index-posts.css">
</head>

<body class="floating nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title"><span id="danilo_topanta_brand"> Danilo Toapanta</span> <a id="mysite" class="mysite" href="../../../../../sites/">MySites</a></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text"><span id="home-welcome-msg">Home</span></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects/index.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about/index.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/danilotpnta?tab=repositories" rel="" target="_blank"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full blog-page" style="display: none;">
    <div class="quarto-title-banner page-columns page-full">
        <div class="quarto-title column-body">
            <h1 class="title">Latent Variable Models &amp; K-Means Clustering</h1>
                
            <!-- Description Block -->
                        <div>
                <div class="description">
                    Lecture Notes UvA on 2-10-2023
                </div>
            </div>
                        
            <!-- Categories Block -->
                                            <div class="quarto-categories">

                    <!-- Display Categories -->
                                            <div class="quarto-category">
                            <a href="../../blog/#category=All">
                                All
                            </a>
                        </div> 
                                            <div class="quarto-category">
                            <a href="../../blog/#category=Education">
                                Education
                            </a>
                        </div> 
                                            <div class="quarto-category">
                            <a href="../../blog/#category=Machine Learning">
                                Machine Learning
                            </a>
                        </div> 
                                            <div class="quarto-category">
                            <a href="../../blog/#category=TAGS">
                                TAGS
                            </a>
                        </div> 
                                            <div class="quarto-category">
                            <a href="../../blog/#category=Python">
                                Python
                            </a>
                        </div> 
                    
                    <!-- Display Tags if any -->
                                    </div>
                            
        </div>
    </div>


    
    <div class="quarto-title-meta">

        <div>
        <div class="quarto-title-meta-heading">Author</div>
        <div class="quarto-title-meta-contents">
                 <p><a href="https://danilotpnta.github.io/">Danilo Toapanta</a> </p>
              </div>
      </div>
        
        <div>
        <div class="quarto-title-meta-heading">Published</div>
        <div class="quarto-title-meta-contents">
          <p class="date">October 7, 2023</p>
        </div>
      </div>
      
        
      </div>
      

    
</header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">
<script>
    var currentUrl = window.location.href;
    var index_init_post = currentUrl.lastIndexOf("/20");
    var string_init_post= currentUrl.slice(index_init_post, index_init_post+3 );

    // console.log("currentUrl: " + currentUrl);
    // console.log("index: " + index_init_post);
    // console.log("string: " + string_init_post);

    // If is equal to /blog/20... then make navbar title READING MODE
    if (string_init_post === "/20"){
        let mysite = document.getElementById("mysite");
        mysite.classList.add("mysite-change");

        let navbar = document.getElementById("danilo_topanta_brand");
        navbar.classList.add("navbar-brand-change");

        // This will render a new title saying READING DANILOS BLOG
        // navbar.innerHTML = 'You are Reading Danilo\'s Blog<span style="font-size:35px; vertical-align: middle; opacity: 0.65; padding-bottom: 6px; padding-left: 14px;" class="material-icons-round"> auto_awesome </span>';
        
        const smallDevice = window.matchMedia("(min-width: 570px)");
        smallDevice.addListener(handleDeviceChange);

        function handleDeviceChange(mediaQuery) {
            if (mediaQuery.matches) {
                navbar.innerHTML = "";
                // navbar.innerHTML = "<-- You are Reading Danilo's Blog -->";
            } else  {
                navbar.innerHTML = "Danilo Toapanta";
            }
        }

        // Run it initially
        handleDeviceChange(smallDevice);

        let link = document.getElementsByClassName("navbar-brand")[0];
        link.classList.add("disablePointerEvents");

        let brand_container = document.getElementsByClassName("navbar-brand-container")[0];
        brand_container.classList.add("navbar-brand-container-new-padding");

    }
</script>


<!-- <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Running my first Marathon</h1>
                  <div>
        <div class="description">
          I will be running at the 42km TCS Amsterdam 2023, 15th October
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">News</div>
              </div>
                  </div>
  </div> -->

  <!-- ---
  coming-soon: true
  tags: [Spanish]
  --- -->








<main id="title-block-header" class="quarto-title-block default page-columns page-full" style="padding-bottom: 40px;">

    <div class="quarto-title column-body" style="margin-bottom: 1em;">
        <h1 class="title" style="padding-bottom:8px" ;="">Latent Variable Models &amp; K-Means Clustering</h1>
        
        <!-- Description Block -->
                    <div>
                <div class="description">
                    Lecture Notes UvA on 2-10-2023
                </div>
            </div>
        
        <!-- Categories Block -->
                    
                <!-- Display Categories -->
                <div class="quarto-categories">
                    <!-- <div id="tag-icon-blog" class="quarto-category tags-title">
                        <i class="fa-solid fa-hashtag" ></i> Categories:
                    </div> -->

                                            <div id="All" class="quarto-category">
                            <a href="../../blog/#category=All">
                                All
                            </a>
                        </div>
                                            <div id="Education" class="quarto-category">
                            <a href="../../blog/#category=Education">
                                Education
                            </a>
                        </div>
                                            <div id="Machine Learning" class="quarto-category">
                            <a href="../../blog/#category=Machine Learning">
                                Machine Learning
                            </a>
                        </div>
                                            <div id="TAGS" class="quarto-category">
                            <a href="../../blog/#category=TAGS">
                                TAGS
                            </a>
                        </div>
                                            <div id="Python" class="quarto-category">
                            <a href="../../blog/#category=Python">
                                Python
                            </a>
                        </div>
                                    </div>
                


                <div class="quarto-categories tag-categories">
                    
                    <!-- Tags Icon  -->
                    <!-- <div id="tag-icon-blog" class="quarto-category tags-title"> -->
                        <!-- <i class="fa-solid fa-tag" ></i> Tags: -->
                        <!-- <i class="fa-solid fa-hashtag" ></i> Tags: -->
                        <!-- <span class="material-icons-outlined" >local_offer</span> Tags: -->
                        <!-- / -->
                    <!-- </div> -->

                    <!-- Display Tags -->
                                            <div id="All-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=All">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                All
                            </a>
                        </div>
                                            <div id="Education-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=Education">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                Education
                            </a>
                        </div>
                                            <div id="Machine Learning-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=Machine Learning">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                Machine Learning
                            </a>
                        </div>
                                            <div id="TAGS-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=TAGS">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                TAGS
                            </a>
                        </div>
                                            <div id="Python-from-here" class="quarto-category tags-title" style="display: none;">
                            <a href="../../blog/#category=Python">
                               <!-- <span class="hasth-tag">
                                #
                                </span> -->
                                Python
                            </a>
                        </div>
                    
                    
                </div>

                    
    </div>


    
    <div class="quarto-title-meta">

        <div>
        <div class="quarto-title-meta-heading">Author</div>
        <div class="quarto-title-meta-contents">
                 <p><a href="https://danilotpnta.github.io/">Danilo Toapanta</a> </p>
              </div>
      </div>
        
        <div>
        <div class="quarto-title-meta-heading">Published</div>
        <div class="quarto-title-meta-contents">
          <p class="date">October 7, 2023</p>
        </div>
      </div>
      
        
      </div>
      

    <!-- Current link: Font-awesome, Google icons, Bootstrap icons -->
    
</main>

<section id="supervised-learning" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="supervised-learning"><span class="header-section-number">1</span> Supervised Learning</h2>
<p>Here the mission of the model is to learn the relation between the labels and the features.</p>
<center>
<img src="2023-10-07-22-37-06.png" class="w400 img-fluid">
</center>
</section>
<section id="unsupervised-learning" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="unsupervised-learning"><span class="header-section-number">2</span> Unsupervised Learning</h2>
<p>You <strong>do not</strong> have labels you only have features.</p>
<p>The mission of the model is to discover latent or hidden structures</p>
<center>
<img src="2023-10-07-22-39-04.png" class="w400 img-fluid">
</center>
<ul>
<li>Unsupervised learning is understanding the data discovering properties to exploit.</li>
</ul>
</section>
<section id="unsupervised-vs.-supervised-learning" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="unsupervised-vs.-supervised-learning"><span class="header-section-number">3</span> Unsupervised vs.&nbsp;Supervised learning</h2>
<center>
<img src="2023-10-07-22-41-42.png" class="w400 img-fluid">
</center>
</section>
<section id="latent-variable-models" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="latent-variable-models"><span class="header-section-number">4</span> Latent variable Models</h2>
<center>
<img src="2023-10-07-23-14-53.png" class="w400 img-fluid">
</center>
<ul>
<li><p>In Unsupervised learning:<br>
You have Latent variable <span class="math inline">\(Z\)</span> and that generates <span class="math inline">\(X\)</span>.</p></li>
<li><p>In supervised learning:<br>
For instance in Classification you would have features <span class="math inline">\(X\)</span> and that generates some label <span class="math inline">\(y\)</span>.</p></li>
</ul>
<blockquote class="blockquote">
<p>So you could think of Unsupervised learning as we are given our labels and we need to learn the features that generate the label</p>
</blockquote>
<p><span class="math inline">\(Z\)</span> in the figure above are the labels. We want to get the distriution of the data in the continuous case i.e.&nbsp;by marginalizing over <span class="math inline">\(z\)</span> to get the probability of the data alone.</p>
</section>
<section id="examples" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="examples"><span class="header-section-number">5</span> Examples</h2>
<center>
<img src="2023-10-07-23-15-28.png" class="w475 img-fluid">
</center>
<pre></pre>
<ul>
<li><p>For instance in <strong>Clustering</strong> we are given scattered plot data and you want to find the hidden groups.</p></li>
<li><p>For instance in <strong>Dimensionality Reduction</strong> you are given a 2-dim data and you wonder whether you can learn a lower representation that could describe my data</p></li>
</ul>
</section>
<section id="k-means-clustering" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="k-means-clustering"><span class="header-section-number">6</span> K-Means Clustering</h2>
<blockquote class="blockquote">
<p>Goal: Automatically partition unlabeled data into groups of similar data points.</p>
</blockquote>
<ul>
<li><strong>Useful for:</strong>
<ul>
<li>Automatically organizing data.</li>
<li>Understanding hidden structure in data.</li>
<li>Preprocessing for downstream analysis.</li>
</ul></li>
</ul>
</section>
<section id="applications" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="applications"><span class="header-section-number">7</span> Applications</h2>
<center>
<img src="2023-10-08-00-56-10.png" class="w400 img-fluid">
</center>
<center>
<img src="2023-10-08-00-56-37.png" class="w400 img-fluid">
</center>
</section>
<section id="clustering-with-k-means" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="clustering-with-k-means"><span class="header-section-number">8</span> Clustering with K-means</h2>
<blockquote class="blockquote">
<p><strong>Goal:</strong> minimize distance between data points and <span class="math inline">\(k\)</span> cluster representations</p>
</blockquote>
<center>
<img src="2023-10-08-11-07-50.png" class="w400 img-fluid">
</center>
<pre></pre>
</section>
<section id="k-means" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="k-means"><span class="header-section-number">9</span> K-means</h2>
<center>
<img src="2023-10-08-11-26-39.png" class="w400 img-fluid">
</center>
<pre></pre>
<ul>
<li>You need to set <span class="math inline">\(K\)</span> the number of clusters ahead of time</li>
<li>The mean <span class="math inline">\(m_j\)</span> per ach cluster</li>
<li>The cluster that corresponds <span class="math inline">\(C_j\)</span></li>
<li>You only compute the <span class="math inline">\(x_n\)</span> that belongs to that cluster <span class="math inline">\(C_j\)</span> so that we do not compute for all data points</li>
</ul>
<center>
<img src="2023-10-08-11-56-38.png" class="w400 img-fluid">
</center>
<ul>
<li><span class="math inline">\(|C_j|\)</span> is the number of datapoints assigned to that cluster <span class="math inline">\(j\)</span></li>
</ul>
</section>
<section id="k-means-clustering-example" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="k-means-clustering-example"><span class="header-section-number">10</span> K-Means Clustering Example</h2>
<p><strong>0.</strong> Randomly initialize <span class="math inline">\(k=3\)</span> means to data points. (That means we will end up with <span class="math inline">\(3\)</span> Clusters)</p>
<center>
<img src="2023-10-08-12-00-20.png" class="w300 img-fluid">
</center>
<pre></pre>
<p><strong>1.</strong> Assign point to cluster with nearest representation.</p>
<center>
<img src="2023-10-08-12-29-05.png" class="w400 img-fluid">
</center>
<pre></pre>
<p><strong>2.</strong> Compute new cluster representation by taking mean of currently assigned points.</p>
<center>
<img src="2023-10-08-12-29-28.png" class="w400 img-fluid">
</center>
<pre></pre>
<p>The coloured points you see above are the new computed means. They are NOT data points they are just the locations where the mean should be.</p>
<p><code>Repeat: Step 1 -&gt; 2</code></p>
<p><strong>1.</strong> Assign point to cluster with nearest representation.</p>
<center>
<img src="2023-10-08-12-29-47.png" class="w400 img-fluid">
</center>
<pre></pre>
<p><strong>2.</strong> Compute new cluster representation by taking mean of currently assigned points.</p>
<center>
<img src="2023-10-08-12-30-02.png" class="w400 img-fluid">
</center>
<pre></pre>
<p><code>Repeat: Step 1 -&gt; 2</code></p>
<p><strong>1.</strong> Assign point to cluster with nearest representation.</p>
<center>
<img src="2023-10-08-12-31-59.png" class="w400 img-fluid">
</center>
<pre></pre>
<p><strong>2.</strong> Compute new cluster representation by taking mean of currently assigned points.</p>
<center>
<img src="2023-10-08-12-32-23.png" class="w400 img-fluid">
</center>
<pre></pre>
<p><code>Converging</code></p>
<p><strong>1.</strong> Assign point to cluster with nearest representation.</p>
<center>
<img src="2023-10-08-12-31-59.png" class="w400 img-fluid">
</center>
<pre></pre>
<blockquote class="blockquote">
<p>Note: The algorithm has <strong>converged</strong>: the cluster assignments do not change. So stop here</p>
</blockquote>
<section id="final-means-and-cluster-assignments" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="final-means-and-cluster-assignments">Final means and cluster assignments</h4>
<center>
<img src="2023-10-08-12-34-43.png" class="w400 img-fluid">
</center>
</section>
</section>
<section id="k-means-clustering-pipeline" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="k-means-clustering-pipeline"><span class="header-section-number">11</span> K-Means Clustering Pipeline</h2>
<p>Our model is represented by our <span class="math inline">\(k\)</span> mean vectors: <span class="math inline">\(\{{m_j\}}_{j=1}^{k}\)</span></p>
<center>
<img src="2023-10-08-14-53-23.png" class="w400 img-fluid">
</center>
</section>
<section id="k-means-optimization" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="k-means-optimization"><span class="header-section-number">12</span> K-Means: Optimization</h2>
<ul>
<li>The number of iterations to get the same error is lower in the second run</li>
<li>The cost in the same iteration number is higuer in the first iteration</li>
</ul>
<center>
<img src="2023-10-08-14-59-13.png" class="w400 img-fluid">
</center>
<center>
<img src="2023-10-08-14-59-20.png" class="w400 img-fluid">
</center>
<p>Algorithm guaranteed to decrease error at each iteration, but <strong>not</strong> guaranteed to obtain <em>Global Optimum</em>.</p>
<p>In between:</p>
<ul>
<li>In Linear Regression you can find the global minimum</li>
<li>In Neural Networks we cannot never find the global optima, we need to adjust our steep size</li>
<li>In K-means you guarantee to reduce error but not guaranteed that if you keep decreasing you will find global minimum.</li>
</ul>
<blockquote class="blockquote">
<p>For the last reason above (the not guaranteeing thing people in practice re-run algorithm multiple times (and take solution with lowest cost, for instance)</p>
</blockquote>
</section>
<section id="k-means-overfitting" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="k-means-overfitting"><span class="header-section-number">13</span> K-Means: Overfitting</h2>
<center>
<img src="2023-10-08-15-05-36.png" class="w450 img-fluid">
</center>
<p>The more clusters we have, the better the chance that a cluster mean will be near held-out data, thus improving the validation error. Thus, looking at <strong>validation error alone</strong> is <em>not helpful</em>.</p>
<p>So how do we quantify this, because the more clusters then the lower the validation error. How do we choose an appropriate <span class="math inline">\(k\)</span>-number: Answer with the <strong>Elbow method</strong> discussed below</p>
</section>
<section id="k-means-choosing-k" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="k-means-choosing-k"><span class="header-section-number">14</span> k-Means: Choosing <span class="math inline">\(k\)</span></h2>
<section id="method-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="method-1">Method 1</h4>
<blockquote class="blockquote">
<p><strong>Elbow method:</strong> is called like this because think about the error function and your arm. Now we look at the point of hinge where the error loss changes significantly.</p>
</blockquote>
<p>For instance in the image below you find your elbow point where adding more cluster does not improve the error.</p>
<center>
<img src="2023-10-08-15-17-08.png" class="w300 img-fluid">
</center>
</section>
<section id="method-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="method-2">Method 2</h4>
<p>Another method to choose an appropiate <span class="math inline">\(k\)</span> value is: to have a <strong>modified error function</strong> that account for the number of clusters:</p>
<center>
<img src="2023-10-08-15-22-49.png" class="w400 img-fluid">
</center>
<pre></pre>
<p>For instance if I have <span class="math inline">\(k=1\)</span> then the <em>newly</em> introduced term becomes zero. But if you have more than one cluster it is going to get penalize with a factor <span class="math inline">\(\lambda\)</span></p>
</section>
<section id="method-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="method-3">Method 3</h4>
<p>Here you do external supervision, that means i.e.&nbsp;you have houses clustering by price and size, if you new or wanted to group some houses intentionally then you could stop the <span class="math inline">\(k\)</span>-size number increasing because you have knowledge domain. Thus you control the granularity.</p>
</section>
<section id="method-4" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="method-4">Method 4</h4>
<center>
<img src="2023-10-08-16-03-01.png" class="w400 img-fluid">
</center>
<pre></pre>
<p>You want the <strong>Dunn index</strong> to be large, meaning you want in the numerator to be large meaning the minimum distance between cluster representations (so between means) should be large and conversely you want the denominator to be small meaning that you want the maximum distance between points within the cluster to be close to one another (meaning we want to have all point very close to the mean of this cluster)</p>
</section>
</section>
<section id="k-means-generalizations" class="level2" data-number="15">
<h2 data-number="15" class="anchored" data-anchor-id="k-means-generalizations"><span class="header-section-number">15</span> K-Means: Generalizations</h2>
<p>You could also compute the error function <span class="math inline">\(E\)</span> with other function rather than squarer error, you could for instance use another distance function like Hamming, or medians like below:</p>
<center>
<img src="2023-10-08-16-06-40.png" class="w400 img-fluid">
</center>
<pre></pre>
</section>
<section id="improvements-for-big-data" class="level2" data-number="16">
<h2 data-number="16" class="anchored" data-anchor-id="improvements-for-big-data"><span class="header-section-number">16</span> Improvements for Big Data</h2>
<ul>
<li>When the data is long then we may take a lot of time to compute one iteration, the solution for this could be to use:
<ul>
<li><strong>Stochastic gradient</strong>: for each datapoint, update nearest cluster mean”</li>
</ul></li>
</ul>
<p>What this equation is allowing us is to compute the mean not looking at all the data points, again we have the value <span class="math inline">\(\eta\)</span> which is our learning rate</p>
<p>The mean that we are computing its only nearest to the cluster we compute it</p>
<center>
<img src="2023-10-08-18-47-53.png" class="w300 img-fluid">
</center>
<pre></pre>
</section>
<section id="application-image-compression" class="level2" data-number="17">
<h2 data-number="17" class="anchored" data-anchor-id="application-image-compression"><span class="header-section-number">17</span> Application: image compression</h2>
<center>
<img src="2023-10-08-18-50-19.png" class="w450 img-fluid">
</center>
<pre></pre>
</section>
<section id="failures-of-k-means" class="level2" data-number="18">
<h2 data-number="18" class="anchored" data-anchor-id="failures-of-k-means"><span class="header-section-number">18</span> Failures of K-Means</h2>
<p>This is because of the reliance of square distance, then the points close to the means do not preserve the non-euclidean aspect of this data</p>
<center>
<img src="2023-10-08-18-53-32.png" class="w400 img-fluid">
</center>
<pre></pre>
<p>Here we should expect to see three clusters: 2 ears and 1 face. The explanation to this is because we cannot modify how th distance will be computed. That means we cannot say that the region of the ears to have a smaller distance, compared to the face’s mean.</p>
<center>
<img src="2023-10-08-19-00-18.png" class="w475 img-fluid">
</center>
<pre></pre>
<p>Another way to look at this problems is that, you cannot change the scale of the clusters, every cluster would have more or less the same square distance around its cluster mean. That means that you cannot have tighter distance for the ears and more relaxed notion of distance for the same. They are gonna have same squared distances with equal weight.</p>
</section>
<section id="pros-cons-of-k-means" class="level2" data-number="19">
<h2 data-number="19" class="anchored" data-anchor-id="pros-cons-of-k-means"><span class="header-section-number">19</span> Pros &amp; Cons of K-Means</h2>
<ul>
<li><strong>Good:</strong>
<ul>
<li>Simple to implement</li>
<li>Fast</li>
</ul></li>
<li><strong>Bad:</strong>
<ul>
<li>Local minima</li>
<li>Model only “spherical” clusters that cannot change size</li>
<li>Sensitive to the features scale</li>
<li>Number of clusters <span class="math inline">\(K\)</span> to be chosen in advance</li>
<li>Cluster assignments are “hard”, not probabilistic =&gt; next topic, Gaussian Mixture Model</li>
</ul></li>
</ul>
</section>
<section id="minimize-error-em-algorithm" class="level2" data-number="20">
<h2 data-number="20" class="anchored" data-anchor-id="minimize-error-em-algorithm"><span class="header-section-number">20</span> Minimize Error (EM Algorithm)</h2>
<blockquote class="blockquote">
<p>The above algorithm can be formalized in the Expectation Maximization</p>
</blockquote>
<ul>
<li>The E step computes the assignments</li>
<li>The M step computes the means</li>
</ul>
<center>
<img src="2023-10-08-19-09-34.png" class="w400 img-fluid">
</center>
<pre></pre>
<p>Same as computing:</p>
<center>
<img src="2023-10-08-19-13-26.png" class="w300 img-fluid">
</center>
<pre></pre>
<section id="derivation-of-m-step" class="level3" data-number="20.1">
<h3 data-number="20.1" class="anchored" data-anchor-id="derivation-of-m-step"><span class="header-section-number">20.1</span> Derivation of M-Step</h3>
<center>
<img src="2023-10-08-19-26-14.png" class="w400 img-fluid">
</center>
<pre></pre>
</section>
</section>
<section id="constrained-optimization" class="level2" data-number="21">
<h2 data-number="21" class="anchored" data-anchor-id="constrained-optimization"><span class="header-section-number">21</span> Constrained optimization</h2>
<center>
<img src="2023-10-08-20-27-22.png" class="img-fluid">
</center>
<pre></pre>
<section id="lagrange-constrained-optimization-example" class="level3" data-number="21.1">
<h3 data-number="21.1" class="anchored" data-anchor-id="lagrange-constrained-optimization-example"><span class="header-section-number">21.1</span> Lagrange Constrained Optimization: Example</h3>
<center>
<img src="2023-10-08-20-28-16.png" class="w575 img-fluid">
</center>
<pre></pre>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../about/index.html"><span class="footerDaniloToapanta">Mantained by Danilo Toapanta</span></a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../coming-soon.html">Newsletter</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../docs/sitemap.xml">RSS</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>

    let navbar = document.getElementsByClassName("navbar-nav")[0]    

    let li2 = document.createElement("li");
    li2.className = "nav-item compact";

    let a2 = document.createElement("a");
    a2.className = "nav-link quarto-color-scheme-toggle";
    a2.style.cursor = "pointer"
    li2.appendChild(a2)

    let i2 = document.createElement("i");
    i2.className = "bi bi-moon"
    a2.append(i2)

    navbar.appendChild(li2);

    i2.onclick = function() {
        window.quartoToggleColorScheme(); return false;
    }
    // <a href="http://localhost:4200/about/" class="quarto-color-scheme-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>

    let li = document.createElement("li");
    li.className = "nav-item compact";

    let a = document.createElement("a");
    a.className = "nav-link";
    a.style.cursor = "pointer"
    li.appendChild(a)

    let i = document.createElement("i");
    i.className = "bi bi-search"
    a.append(i)

    // let span = document.createElement("span");
    // span.className = "menu-text"
    // a.append(span)

    navbar.appendChild(li);

    a.onclick = function() {
        window.quartoOpenSearch()
    }


</script>





</body></html>