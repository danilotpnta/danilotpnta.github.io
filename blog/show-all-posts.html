<script id='script-part'>
    var showCategories = false;

    // ------------------------- ON WINDOWS LOAD -------------------------
    window.onload = function(){
      var currentUrl = window.location.href;
      var index_hashtag = currentUrl.lastIndexOf("#");
      var index_slash = currentUrl.lastIndexOf("/");
      // console.log("index_hashtag: " + index_hashtag + " index_slash: " + index_slash);
    
      var filename2 = currentUrl.substr(index_slash);
    
      if (! (index_hashtag === -1) ){
        showCategories = true;
        showhideCategory();
      }

      if (filename2 === "/"){
        showCategories = false;
        showhideCategory();
      }

      // Defining variables to handle hover and  
      // background when https:....../#category= is reloaded
      var index_equal = currentUrl.lastIndexOf("=");
      var id_name = currentUrl.substr(index_equal);
      
      // Slice symbol "=", Shows only Category
      id_name = id_name.slice(1);
      
      // If contains special chr "%20" then replace it to "\ "
      const substr = "%20";
      if (id_name.includes(substr)){
        id_name = id_name.replace(substr, "\ ");        
      } 

      var raw_array_categories = [];
      var raw_array_tags = [];
      var array_categories = {};
      var array_tags = {};

      getElements_from_array('.array_categories', raw_array_categories)
      getElements_from_array('.array_tags', raw_array_tags)
      countElements(raw_array_categories, array_categories);
      countElements(raw_array_tags, array_tags);

      // console.log(id_name)
      // display the text only if there is a name for the tag or category
      // and if is array of tags or categories
      if( !(id_name === "") && ( (raw_array_categories.includes(id_name))  || (raw_array_tags.includes(id_name))  )) {
        changeText(id_name);

      }

      if (raw_array_categories.includes(id_name)){
        // console.log(`accesing dict category: ${array_categories[id_name]}, with id: ${id_name}`);
        changeGreenNumber(array_categories[id_name], 'categorized:' );
      } else {
        // console.log(`accesing dict tags: ${array_tags[id_name]}, with id: ${id_name}`);
        changeGreenNumber(array_tags[id_name],'tagged:');
      }

      // Changes back to normal dark grey div 'Showing all Posts'
      if (currentUrl.includes("#category=All")){
        displayCategories(false);
        var show_info_tag_cat = document.getElementById("show-tag-cat-selected");
        show_info_tag_cat.style.display = "none"  
      }

      // Makes remaining CATEGORIES have normal hover
      document.querySelectorAll('.array_categories').forEach(item => {
        item_cleaned = item.textContent.trim();
        // console.log("item_cleaned_cat: " + item_cleaned);
        if (! (item_cleaned === id_name)){
          handle_id(item_cleaned, "grey");
        }
      });

      // Makes remaining TAGS have normal hover
      document.querySelectorAll('.array_tags').forEach(item => {
        item_cleaned = item.textContent.trim();
        // console.log("item_cleaned_tag: " + item_cleaned);
        if (! (item_cleaned === id_name)){
          handle_id(item_cleaned, "grey");
        }
      });

      // Makes focused Category/Tag have green background
      handle_id(id_name, "rgba(88, 226, 104, 0.21)")

      // If the table listing does not have rows then erase "2023" and "No Matching..."
      var raw_array_ids_tables = [];
      getElements_from_array('.array_ids_tables', raw_array_ids_tables);

      for (var i = 0; i < raw_array_ids_tables.length; i ++) {
        // console.log(raw_array_ids_tables[i]);
        let num_rows = document.getElementById(raw_array_ids_tables[i]).rows.length
        // console.log(num_rows)

        let titles_tables = document.getElementById(`${raw_array_ids_tables[i]}-title`);

        if ( num_rows == 0 ){
          titles_tables.style.display = "none" ; 
        // } else if (currentUrl.includes("#category=All")){
          // titles_tables.style.display = "inherit" ; 
        } 
        if ( num_rows > 0 ) {
          titles_tables.style.display = "inherit" ; 
        }
        if (currentUrl.includes("#category=All")){
          titles_tables.style.display = "inherit" ; 
        }

      }
      
    }

    // ------------------------- ON # HASHTAG CHANGE -------------------------
    window.addEventListener('hashchange', function() { 

      var currentUrl = window.location.href;
      var index_hashtag = currentUrl.lastIndexOf("#");      
      var filename1 = currentUrl.substr(index_hashtag);

      // // window.alert("location changed! " + filename1); 
      // if (!(filename1 === "#writing" || filename1 === "#section" )){
      //   showCategories = true;
      //   showhideCategory();
      // }

      showCategories = true;
      showhideCategory();

      var index_equal = currentUrl.lastIndexOf("=");
      var id_name = currentUrl.substr(index_equal);
      
      // Slice symbol "=", Shows only Category
      id_name = id_name.slice(1);
      
      // If contains special chr "%20" then replace it to "\ "
      const substr = "%20";
      if (id_name.includes(substr)){
        id_name = id_name.replace(substr, "\ ");        
      } 

      var raw_array_categories = [];
      var raw_array_tags = [];
      var array_categories = {};
      var array_tags = {};

      getElements_from_array('.array_categories', raw_array_categories)
      getElements_from_array('.array_tags', raw_array_tags)
      countElements(raw_array_categories, array_categories);
      countElements(raw_array_tags, array_tags);

      // display the text only if there is a name for the tag or category
      // and if is array of tags or categories
      if( !(id_name === "") && ( (raw_array_categories.includes(id_name))  || (raw_array_tags.includes(id_name))  )) {
        changeText(id_name);
      }

      if (raw_array_categories.includes(id_name)){
        // console.log(`accesing dict category: ${array_categories[id_name]}, with id: ${id_name}`);
        changeGreenNumber(array_categories[id_name], 'categorized:' );
      } else {
        // console.log(`accesing dict tags: ${array_tags[id_name]}, with id: ${id_name}`);
        changeGreenNumber(array_tags[id_name],'tagged:');
      }

      // Changes back to normal dark grey div 'Showing all Posts'
      if (currentUrl.includes("#category=All")){
        displayCategories(false);
        var show_info_tag_cat = document.getElementById("show-tag-cat-selected");
        show_info_tag_cat.style.display = "none"  
      } 

      // Makes remaining CATEGORIES have normal hover
      document.querySelectorAll('.array_categories').forEach(item => {
        item_cleaned = item.textContent.trim();
        // console.log("item_cleaned_cat: " + item_cleaned);
        if (! (item_cleaned === id_name)){
          handle_id(item_cleaned, "grey");
        }
      });

      // Makes remaining TAGS have normal hover
      document.querySelectorAll('.array_tags').forEach(item => {
        item_cleaned = item.textContent.trim();
        // console.log("item_cleaned_tag: " + item_cleaned);
        if (! (item_cleaned === id_name)){
          handle_id(item_cleaned, "grey");
        }
      });

      // Makes focused Category/Tag have green background
      handle_id(id_name, "rgba(88, 226, 104, 0.21)")


      // If the table listing does not have rows then erase "2023" and "No Matching..."
      var raw_array_ids_tables = [];
      getElements_from_array('.array_ids_tables', raw_array_ids_tables);

      for (var i = 0; i < raw_array_ids_tables.length; i ++) {
        // console.log(raw_array_ids_tables[i]);
        let num_rows = document.getElementById(raw_array_ids_tables[i]).rows.length
        // console.log(num_rows)

        let titles_tables = document.getElementById(`${raw_array_ids_tables[i]}-title`);

        if ( num_rows == 0 ){
          titles_tables.style.display = "none" ; 
        // } else if (currentUrl.includes("#category=All")){
          // titles_tables.style.display = "inherit" ; 
        } 
        if ( num_rows > 0 ) {
          titles_tables.style.display = "inherit" ; 
        }

        if (currentUrl.includes("#category=All")){
          titles_tables.style.display = "inherit" ; 
        }



      }

    });

    // ------------------------- HELPER FUNCTIONS -------------------------

    // Makes GREEN only to active category 
    function handle_id(name, color) {
      // console.log("name: " + name);
      if ( !(name === "") && !(name === "All")  ){
        // console.log("entering here");
        var elm = document.getElementById(name);

        if (color == "grey"){
          elm.classList.remove("active")
          elm.classList.remove("hoverMainId-blog")
        } else {
          elm.classList.add("active")
          elm.classList.add("hoverMainId-blog")
        }
      }
    }

    // Count same elements in array
    function countElements (array_to_be_counted,array_counts){
      array_to_be_counted.forEach(function (x) { array_counts[x] = (array_counts[x] || 0) + 1; });
    }
    
    // Get all the elements store in an array and push it to array name
    function getElements_from_array (class_name, array_name){
        document.querySelectorAll(class_name).forEach(item => {
          item_cleaned = item.textContent.trim();
          array_name.push(item_cleaned);
        });
    }

    // Places the number of CATEGORY or TAG posts counted
    // and changes where is category or tag

    function changeGreenNumber (number, is_cat_or_tag){
      var number_green = document.getElementById("green_number_blog");
      number_green.textContent = number;

      var tag_cat_label = document.getElementById("tagged_categorized_as");
      let text1 = "post";
      let text2 = "posts";

      if (number == 1){
        tag_cat_label.textContent = text1.concat(" ", is_cat_or_tag);
      }
      else{ 
        tag_cat_label.textContent = text2.concat(" ", is_cat_or_tag);
      }
      
    }


    //Places the CATEGORY or TAG name to display
    function changeText(name_tu_put){
      var tag_cat_name = document.getElementById("tag_category_name");
      tag_cat_name.textContent = name_tu_put;  

      var show_info_tag_cat = document.getElementById("show-tag-cat-selected");
      show_info_tag_cat.style.display = "contents"  

    }

    // Hides or Displays the two col grid div
    function displayCategories(boolean) {

      // Displays "Show All Posts w/ Reload icon"
      if (boolean == true){
        
        // HIDES: "Showing All Posts"
        var paragraph = document.getElementById("showing-all-posts");
        paragraph.style.display = "none"

        // ENABLES LINK: clickable-show-all-categories
        var link = document.getElementById("clickable-show-all-posts")
        link.style.pointerEvents = "all"

        // Displays the arrow back
        var icon_reload = document.getElementById('reload-posts-icon');
        icon_reload.style.display = "contents";
        icon_reload.style.pointerEvents = "all"
        icon_reload.classList.remove("color-show-posts")
      }

      // Hides "Show All Posts w/ Reload icon"
      if (boolean == false) {

        // HIDES: clickable-show-all-categories
        // var link = document.getElementById("clickable-show-all-posts")
        // link.style.display = "none"

        // HIDES: "Showing All Posts "
        var icon_reload = document.getElementById('reload-posts-icon');
        icon_reload.style.display = "none";

        // ENABLES: "Showing All Posts"
        var paragraph = document.getElementById("showing-all-posts");
        paragraph.style.display = "contents"

        // DISABLE LINK: clickable-showing-all-categories
        // var link = document.getElementById("clickable-showing-all-posts")
        // link.style.pointerEvents = "none"


      }

    }
    

    function showhideCategory() {
        if (showCategories){
        
          // HIDES: "Showing All Posts"
          var paragraph = document.getElementById("showing-all-posts");
          paragraph.style.display = "none"

          // ENABLES LINK: clickable-show-all-posts
          var link = document.getElementById("clickable-show-all-posts")
          link.style.pointerEvents = "all"

          // Displays the arrow back
          var icon_reload = document.getElementById('reload-posts-icon');
          icon_reload.style.display = "contents";
          icon_reload.style.pointerEvents = "all"
          icon_reload.classList.remove("color-show-posts")

        }

    }
    

</script>